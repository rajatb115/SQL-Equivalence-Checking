with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT people.playerid, namefirst AS firstname, 2 * SUM(COALESCE(H2B, 0)) + 3 * SUM(COALESCE(H3B, 0)) + 4 * SUM(COALESCE(HR, 0)) AS runscore FROM people JOIN batting ON people.playerid = batting.playerid GROUP BY people.playerid, namefirst ORDER BY runscore DESC, firstname DESC, people.playerid LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
with t1 as ( select playerID, COALESCE(sum(h2b),0) as d,  COALESCE(sum(h3b),0) as t, COALESCE(sum(HR),0) as h from batting group by playerID ), t as ( select playerID, (2*d + 3*t + 4*h) as runscore from t1 ) select t.playerID as playerid, nameFirst as firstname, runscore from t, people where t.playerID=people.playerID order by runscore desc, firstname desc, playerid asc limit 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT people.playerid, namefirst AS firstname, SUM(2*COALESCE(batting.h2b,0) + 3*COALESCE(batting.h3b,0) + 4*COALESCE(batting.hr,0)) AS runscore FROM people JOIN batting ON batting.playerid = people.playerid GROUP BY people.playerid, firstname ORDER BY runscore DESC, firstname DESC, people.playerid ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT t1.playerID AS playerid, People.nameFirst AS firstname, ( (t1.Doubles)*2 + (t1.Triples)*3 + (t1.Home_Run)*4) AS runscore FROM People JOIN (SELECT playerID , SUM(COALESCE(Batting.H2B,0)) AS Doubles, SUM(COALESCE(Batting.H3B,0)) AS Triples,  SUM(COALESCE(Batting.HR,0)) AS Home_Run FROM Batting GROUP BY playerID) AS t1 ON t1.PlayerID = People.playerID ORDER BY runscore DESC, firstname DESC, playerid LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT People.playerID as playerid,nameFirst as firstname,bat.runscore FROM People ,( SELECT playerID,sum(2*coalesce(H2B,0)+3*coalesce(H3B,0)+4*coalesce(HR,0)) as runscore FROM Batting GROUP BY playerID ORDER BY runscore DESC LIMIT 10 ) as bat WHERE People.playerID=bat.playerID ORDER BY runscore DESC,firstname DESC,playerid ASC ;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT People.playerID AS playerid, COALESCE(nameFirst, '') AS firstname, runscore FROM People JOIN ( SELECT (2*COALESCE(SUM(H2B), 0) + 3*COALESCE(SUM(H3B), 0) + 4*COALESCE(SUM(HR), 0)) AS runscore, playerID FROM Batting GROUP BY playerID) AS t ON People.playerID = t.playerID ORDER BY runscore DESC, firstname DESC, playerid LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT playerID AS playerid, nameFirst AS firstname, SUM(2*H2B+3*H3B+4*HR) AS runscore FROM People NATURAL JOIN Batting WHERE H2B IS NOT NULL AND H3B IS NOT NULL AND HR IS NOT NULL GROUP BY playerID, nameFirst ORDER BY runscore DESC, nameFIRST DESC, playerID ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
select batting.playerID as playerid, nameFirst as firstname, sum(2*coalesce(h2b,0)+3*coalesce(h3b,0)+4*coalesce(hr,0)) as runscore from batting, people where batting.playerID = people.playerID group by batting.playerid,firstname order by runscore desc, nameFirst desc, playerid limit 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
with t as ( select people.playerid, nameFirst as firstname, (2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as r from people, batting where people.playerid = batting.playerid ) select playerid, firstname,sum(r) as runscore from t group by playerid,  firstname order by runscore desc, firstname desc limit 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
select people.playerid,people.namefirst as firstname,SUM(2*batting.h2b + 3*batting.h3b + 4*batting.hr) as runscore  from people join batting on people.playerid=batting.playerid  where(batting.h2b>=0 AND batting.h3b>=0 AND batting.hr>=0)  group by people.playerid,people.namefirst order by runscore  DESC, firstname DESC,playerid ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
CREATE VIEW v1 AS SELECT playerID, 2*COALESCE(SUM(H2B),0)+3*COALESCE(SUM(H3B),0)+4*COALESCE(SUM(HR),0) AS runscore FROM Batting GROUP BY playerID ORDER BY runscore DESC LIMIT 10; SELECT v1.playerID, COALESCE(nameFirst,'') as firstname, runscore FROM v1 LEFT JOIN People ON v1.playerID = People.playerID ORDER BY runscore DESC, nameFirst DESC,  v1.playerID ASC; DROP VIEW v1;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
WITH total1(playerID,double,triple,homerun) AS (SELECT playerID,coalesce(sum(H2B),0),coalesce(sum(H3B),0),coalesce(sum(HR),0) from Batting group by playerID), total(playerID,runscore) AS (SELECT playerID,2*double+3*triple+4*homerun as run from total1 order by run DESC limit 10) SELECT distinct total.playerID,coalesce(people.namefirst,'') as firstname,total.runscore from total,people where total.playerID=people.playerID order by total.runscore DESC,firstname DESC,total.playerID ASC;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
WITH t1 AS ( SELECT playerid, SUM(2 * COALESCE(h2b,0::int) + 3 * COALESCE(h3b,0::int) + 4 * COALESCE(hr,0::int)) as runscore FROM batting GROUP BY playerid ) SELECT t1.playerid, COALESCE(nameFirst,'') as firstname, runscore FROM People JOIN t1 ON People.playerid = t1.playerid ORDER BY runscore DESC, firstname ASC, playerid ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT batting.playerID, namefirst AS firstname, SUM(COALESCE(H2B , 0 )*2 + COALESCE(H3B, 0 )*3 + COALESCE(HR, 0)*4 ) AS runscore FROM batting, people WHERE batting.playerID = people.playerID GROUP BY batting.playerID , namefirst ORDER BY runscore DESC , firstname DESC , playerID LIMIT 10 ;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
Select People.playerID as playerid,People.nameFirst as firstname, SUM(2*coalesce(Batting.H2B,0)+3*coalesce(Batting.H3B,0)+4*coalesce(Batting.HR,0)) as runscore FROM People JOIN Batting ON Batting.playerID=People.playerID group by People.playerID,People.nameFirst ORDER BY runscore DESC,People.nameFirst ASC,People.playerID ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
WITH sub1 as (SELECT playerid, CASE WHEN H2B is NULL THEN 0 ELSE H2B END AS H2B, CASE WHEN H3B IS NULL THEN 0 ELSE H3B END AS H3B, CASE WHEN HR IS NULL THEN 0 ELSE HR END AS HR FROM batting), sub2 as (SELECT playerid, SUM(2*H2B + 3*H3B + 4*HR) as runscore FROM SUB1 GROUP BY playerid) SELECT sub2.playerid, CASE WHEN namefirst IS NULL THEN '' ELSE namefirst END AS firstname, runscore FROM sub2 JOIN people ON sub2.playerid = people.playerid ORDER BY runscore DESC, firstname ASC, playerid FETCH NEXT 10 ROWS ONLY;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
with runscore_table as ( select playerID, sum(2*coalesce(H2B,0)+3*coalesce(H3B,0)+4*coalesce(HR,0)) as runscore from Batting group by playerID ) select People.playerID as playerid, nameFirst as firstname, runscore from runscore_table join People on runscore_table.playerID = People.playerID order by runscore desc, firstname desc, playerid asc limit 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT people.playerid as playerid, namefirst as firstname, SUM( 2 * COALESCE(h2b, 0) + 3 * COALESCE(h3b, 0) + 4 * COALESCE(hr, 0) ) as runscore FROM people JOIN batting ON people.playerid = batting.playerid GROUP BY 1, 2 ORDER BY runscore DESC, firstname DESC, playerid ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
select sq.playerID, COALESCE(namefirst, '') as firstname, runscore from (select playerID, sum(COALESCE(2*H2B, 0)+COALESCE(3*H3B, 0)+COALESCE(4*HR, 0)) as runscore from Batting group by playerID) as sq, People where People.playerID=sq.playerID order by runscore desc, firstname desc, playerID limit 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT DISTINCT People.playerID, People.nameFirst AS firstname, SUM( 2*COALESCE(Batting.H2B,0) + 3*COALESCE(Batting.H3B,0) + 4*COALESCE(Batting.HR,0)) AS runscore FROM People JOIN Batting ON People.playerID = Batting.playerID GROUP BY People.playerID, People.nameFirst ORDER BY runscore DESC, People.nameFirst ASC, People.playerID ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
With top_10 as ( With sum_runscore as ( SELECT playerid, sum(coalesce(2*H2B + 3*H3B + 4*HR,0)) as total_runscore FROM Batting GROUP BY playerid ) SELECT * FROM sum_runscore ORDER BY total_runscore DESC LIMIT 10) SELECT top_10.playerid, p.nameFirst as firstname, top_10.total_runscore as runscore FROM (top_10 JOIN (SELECT playerID, nameFirst from People) as p on top_10.playerid = p.playerid) ORDER BY total_runscore DESC, nameFirst ASC, playerid ASC;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT playerid, nameFirst AS firstname, run_score AS runscore FROM (SELECT playerid, nameFirst, SUM(total) AS run_score FROM (SELECT playerid, nameFirst, (double+triple+home) AS total FROM (SELECT people.playerid, people.nameFirst, 2* (batting.H2B) AS double, 3*(batting.H3B) AS triple, 4*(batting.HR) AS HOME FROM people JOIN Batting ON batting.playerid = people.playerid) AS table_1) AS table_2 GROUP BY playerid, nameFirst) AS table_3 WHERE run_score != 0 ORDER BY runscore DESC, nameFirst DESC, playerid LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
select p.playerID, p.nameFirst as firstname, sum(2*coalesce(b.H2B, 0) + 3*coalesce(b.H3B, 0) + 4*coalesce(b.HR, 0)) as runscore from  Batting b left join People p on b.playerID = p.playerID group by p.playerID, p.nameFirst order by runscore desc, p.nameFirst desc, p.playerID asc limit 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT playerID , firstname, SUM(totalruns) as runscore FROM (SELECT people.playerID, nameFirst as firstname,(COALESCE(H2B,0)*2 + COALESCE(H3B,0)*3 + COALESCE(HR,0)*4) as totalruns FROM people,batting WHERE people.playerID= batting.playerID) as tbl GROUP BY playerID, firstname ORDER BY SUM(totalruns) DESC, firstname DESC , playerID ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT Batting.playerID AS playerid, People.nameFirst AS firstname, SUM(2*COALESCE(Batting.H2B,0) + 3*COALESCE(Batting.H3B,0) + 4*COALESCE(Batting.HR,0)) AS runscore FROM Batting INNER JOIN People ON People.playerID = Batting.playerID GROUP BY Batting.playerID, People.nameFirst Order By runscore DESC, firstname DESC, firstname DESC, playerid ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
select people.playerid, nameFirst as firstname, runscore from people, (select playerid , sum(runscore) as runscore from (select playerid , (2*h2b + 3*h3b + 4*hr) as runscore from batting) as t group by playerid) as t2 where t2.playerID = people.playerid and runscore is not null order by runscore desc, firstname asc, playerid desc limit 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
WITH batting_score AS ( SELECT playerid, (2 * h2b) + (3 * h3b) + (4 * hr) AS runscore FROM batting ) SELECT t.playerid, nameFirst AS firstname, runscore FROM ( SELECT playerid, SUM(runscore) AS runscore FROM batting_score WHERE runscore IS NOT NULL GROUP BY playerid ORDER BY SUM(runscore) DESC LIMIT 10 ) AS t JOIN people ON people.playerid = t.playerid ORDER BY runscore DESC, firstname DESC, playerid ASC;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT people.playerid,nameFirst as firstname, SUM(Coalesce(2*H2B+3*H3B+4*HR,0)) as runscore FROM batting join people on batting.playerid=people.playerid GROUP BY people.playerid,nameFirst ORDER BY runscore DESC, nameFirst DESC, playerid Asc LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
WITH Runscores AS (SELECT People.playerID, CASE WHEN nameFirst IS NOT NULL THEN nameFirst ELSE '' END AS firstname,  CASE WHEN HR IS NOT NULL THEN HR ELSE 0 END AS HR1, CASE WHEN H2B IS NOT NULL THEN H2B ELSE 0 END AS H2B1, CASE WHEN H3B IS NOT NULL THEN H3B ELSE 0 END AS H3B1 FROM People, Batting WHERE People.playerID = Batting.playerID GROUP BY People.playerid, firstname, HR, H2B, H3B) SELECT Runscores.playerid, firstname, SUM (HR1*4 + H3B1*3 + H2B1*2) AS runscore FROM Runscores GROUP BY Runscores.playerid, firstname ORDER BY runscore DESC, firstname DESC, playerid ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
select p.playerID as playerid,p.nameFirst as firstname,(2*coalesce(sum(b.H2B),0)+3*coalesce(sum(b.H3B),0)+4*coalesce(sum(HR),0)) as runscore from People p,Batting b where p.playerID=b.playerID group by p.playerID,p.nameFirst order by runscore desc,p.nameFirst desc,p.playerID asc limit 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT temp.playerID, nameFirst AS firstname, temp.runscore FROM People, (SELECT playerid, SUM(2*COALESCE(H2B,0) + 3*COALESCE(H3B,0) + 4*COALESCE(HR,0)) AS runscore FROM batting GROUP BY playerid ) AS temp WHERE temp.playerID=People.playerID ORDER BY runscore DESC, firstname DESC, temp.PlayerID ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT a.playerid, a.nameFirst AS firstname, b.runscore FROM People a, (SELECT playerID, SUM((2* COALESCE(h2B,0) + 3*COALESCE(h3B,0) + 4*COALESCE(hr,0))) AS runscore FROM Batting GROUP BY playerID ORDER BY runscore DESC LIMIT 10) b WHERE a.playerid = b.playerid ORDER BY runscore DESC, firstname ASC, playerid ASC;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT Batting.playerID AS playerid, People.nameFirst AS firstname, SUM(COALESCE((2 * Batting.H2B+ 3 * Batting.H3B + 4 * Batting.HR),0)) AS runscore FROM Batting INNER JOIN People ON Batting.playerID = People.playerID GROUP BY Batting.playerID, People.nameFirst ORDER BY runscore DESC, firstname DESC, playerid ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT b.playerID as playerid, p.nameFirst as firstname, (4*COALESCE(sum(b.HR),0) + 3*COALESCE(sum(b.H3B), 0) + 2*COALESCE(sum(b.H2B), 0)) as runscore FROM people p, batting b WHERE p.playerID = b.playerID GROUP BY b.playerid, firstname ORDER BY runscore DESC, firstname ASC, playerid ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
select distinct people.playerid, coalesce(people.namefirst,'') as firstname, ( (2 * sum(coalesce(batting.h2b, 0))) + 3 * sum(coalesce(batting.h3b, 0)) + 4 * sum(coalesce(batting.hr, 0)) ) as runscore from batting join people on people.playerid = batting.playerid group by people.playerid, firstname order by runscore desc, firstname desc, people.playerid asc limit 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT people.playerid, COALESCE(nameFirst,'') AS firstname, SUM(2 * H2B + 3 * H3B + 4 * HR) AS runscore FROM people JOIN batting ON people.playerid = batting.playerid AND R IS NOT NULL GROUP BY people.playerid,nameFirst ORDER BY runscore DESC, firstname DESC, people.playerid LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT People.playerID as playerid, nameFirst as firstname, (2*SUM(COALESCE(H2B,0)) + 3*SUM(COALESCE(H3B,0)) + 4*SUM(COALESCE(HR,0))) as runscore FROM People JOIN Batting ON People.playerID = Batting.playerID GROUP BY People.playerID, nameFirst ORDER BY runscore DESC, nameFirst DESC, People.playerID LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT DISTINCT People.playerID as playerid, nameFirst as firstname, runscore FROM People JOIN ( SELECT playerID, sum(runs) as runscore FROM ( SELECT playerID, 2*COALESCE(H2B, 0) + 3*COALESCE(H3B, 0) + 4*COALESCE(HR, 0) AS runs FROM Batting) AS v GROUP BY playerID ORDER BY runscore DESC LIMIT 10 ) AS w ON People.playerID = w.playerID ORDER BY runscore DESC, firstname DESC, People.playerID;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT playerid, firstname, runscore FROM ( SELECT playerid, SUM(2 * COALESCE(h2b, 0) + 3 * COALESCE(h3b, 0) + 4 * COALESCE(hr, 0)) AS runscore FROM batting GROUP BY playerid ) AS tempBatting NATURAL JOIN ( SELECT playerid, COALESCE(nameFirst, '') AS firstname FROM people ) AS tempPeople ORDER BY runscore DESC, firstname DESC, playerid ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT People.playerID as playerid, nameFirst as firstname, COALESCE(SUM(2*H2B+3*H3B+4*HR), 0) AS runscore FROM People JOIN Batting ON People.playerID = Batting.playerID GROUP  BY People.playerID, nameFirst ORDER BY runscore DESC, nameFirst ASC, People.playerID ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT batting.playerID AS playerid,COALESCE(people.nameFirst,'') AS firstname,SUM(COALESCE(2*(COALESCE(batting.H2B,0))+ 3*(COALESCE(batting.H3B,0))+4*(COALESCE(batting.HR,0)),0)) AS runscore FROM batting INNER JOIN people ON batting.playerID=people.playerID GROUP BY batting.playerID,firstname ORDER BY runscore DESC,firstname DESC,playerid LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
with ne as(SELECT * FROM batting where batting.H2B is not null and batting.H3B is not null and batting.HR is not null) SELECT newtable.ID as playerid,people.nameFirst as firstname,newtable.SU   as runscore FROM (SELECT ne.playerID,SUM(2*ne.H2B+3*ne.H3B+4*ne.HR) AS total FROM ne GROUP BY ne.playerID) as newtable(ID,SU) INNER JOIN people  ON people.playerID = newtable.ID order by runscore DESC,firstname DESC,playerid ASC  limit 10
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT c.playerID,People.nameFirst,c.runscore FROM People INNER JOIN (SELECT playerID,SUM(2*COALESCE(H2B,0)+3*COALESCE(H3B,0)+4*COALESCE(HR,0)) as runscore FROM Batting GROUP BY playerID ORDER BY runscore DESC LIMIT 10) AS c ON People.playerID = c.playerID ORDER BY c.runscore DESC , People.nameFirst DESC;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT people.playerID as playerid, namefirst as firstname, SUM(COALESCE(2*H2B+3*H3B+4*HR, 0)) as runscore FROM (people JOIN batting ON people.playerID = batting.playerID) GROUP BY people.playerid, people.namefirst ORDER BY runscore DESC, firstname DESC, playerid LIMIT 10 ;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
select people.playerID as playerid, people.nameFirst as firstname, t.runscore as runscore from people, (select playerID, 2*sum(h2b)+3*sum(h3b)+4*sum(hr) as runscore from batting where h2b+h3b+hr>0 group by playerID) as t where people.playerID = t.playerID order by runscore desc, firstname desc, playerid asc fetch first 10 rows only;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT t.playerid, namefirst AS firstname, runscore FROM people JOIN ( SELECT playerID, COALESCE(SUM(2*H2B + 3*H3B + 4*HR),0) AS runscore FROM batting GROUP BY playerID ) AS t ON people.playerID=t.playerID ORDER BY runscore DESC, firstname ASC, playerid ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT People.playerid,nameFirst AS firstname,COALESCE(SUM(2*H2B+3*H3B+4*HR),0) AS runscore FROM People JOIN Batting ON People.playerID = Batting.PlayerID GROUP BY People.playerID,nameFirst ORDER BY runscore DESC,nameFirst DESC,People.playerID ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT People.playerid, coalesce(nameFirst,'') as firstname,runscore FROM People JOIN (SELECT playerid,2*SUM(coalesce(h2B,0))+3*SUM(coalesce(h3B,0))+4*SUM(coalesce(HR,0)) as runscore FROM Batting GROUP BY playerid) AS Aux ON Aux.playerid = People.playerid ORDER BY runscore DESC,firstname DESC,People.playerid ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT DISTINCT Batting.playerID AS playerid, People.nameFirst AS firstname, SUM((2*Batting.H2B + 3*Batting.H3B + 4*Batting.HR)) AS runscore FROM Batting, People WHERE Batting.playerID = People.playerID AND H2B IS NOT NULL AND H2B IS NOT NULL AND HR IS NOT NULL GROUP BY Batting.playerID, People.nameFirst ORDER BY runscore DESC, firstname DESC, playerID ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT temp.playerid, nameFirst as firstname, temp.runscore FROM People JOIN ( SELECT playerid, SUM(2*COALESCE(h2b,0) + 3*COALESCE(h3b,0) + 4*COALESCE(HR,0)) AS runscore FROM Batting GROUP BY playerid ) AS temp ON temp.playerid =  People.playerid ORDER BY runscore DESC, firstname DESC, playerid LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT people.playerid, namefirst AS firstname, sum(2*h2b + 3*h3b + 4*hr) AS runscore FROM people, batting AS b WHERE people.playerid = b.playerid AND (h2b > 0 OR h3b > 0 OR hr > 0) GROUP BY people.playerid, namefirst ORDER BY runscore DESC, firstname DESC, playerid ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT People.playerID AS playerid, People.nameFirst AS firstname, SUM(COALESCE((2*Batting.H2B + 3*Batting.H3B + 4*Batting.HR), 0)) AS runscore FROM People LEFT JOIN Batting ON People.playerID = Batting.playerID GROUP BY People.playerID, People.nameFirst ORDER BY runscore DESC, firstname DESC, playerid ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT batting.playerid as playerid, people.nameFirst as firstname, (2*SUM(h2b) + 3*SUM(h3b) + 4*SUM(hr)) as runscore FROM batting,people WHERE batting.playerid = people.playerid GROUP BY batting.playerid,people.nameFirst HAVING (2*SUM(h2b) + 3*SUM(h3b) + 4*SUM(hr)) IS NOT NULL ORDER BY runscore DESC,people.nameFirst DESC,playerid ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT Batting.playerID, nameFirst AS firstname, SUM(2*COALESCE(h2b,0)+3*COALESCE(h3b,0)+4*COALESCE(hr,0)) AS runscore FROM Batting, People WHERE Batting.playerID = People.playerID GROUP BY Batting.playerID, firstname ORDER BY runscore DESC, firstname, Batting.playerID LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
WITH table1 AS ( SELECT playerid, SUM(2 * COALESCE(batting.h2b, 0) + 3 * COALESCE(batting.h3b, 0) + 4 * COALESCE(batting.hr, 0)) AS runscore FROM batting GROUP BY playerid ) SELECT table1.playerid AS playerid, COALESCE(nameFirst, '') AS firstname, runscore FROM table1 INNER JOIN people ON people.playerid = table1.playerid ORDER BY runscore DESC, firstname DESC, playerid LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
select t.playerID, nameFirst as firstname, runscore from ( select playerID, coalesce(runscore_null, 0) as runscore from ( select playerID, sum(runs) as runscore_null from ( select playerID, (2*h2b + 3*h3b + 4*hr) as runs from batting ) as t2 group by playerID ) as t3 ) as t JOIN People ON People.playerID = t.playerID order by runscore desc, nameFirst desc, playerID limit 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
WITH top_run_scorers AS ( SELECT playerid,  SUM(2*COALESCE(h2b, 0) + 3*COALESCE(h3b, 0) + 4*COALESCE(hr, 0)) AS runscore FROM batting GROUP BY playerid ) SELECT people.playerid, COALESCE(nameFirst,'') AS firstname, runscore FROM top_run_scorers JOIN people on people.playerid = top_run_scorers.playerid ORDER BY runscore DESC, firstname ASC, playerid ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT batting.playerid as playerid, COALESCE(people.namefirst,'') as firstname, COALESCE(SUM(2*batting.h2B),0) + COALESCE(SUM(3*batting.h3B),0) + COALESCE(SUM(4*batting.HR),0) as runscore FROM batting, people WHERE batting.playerid = people.playerid GROUP BY batting.playerid, namefirst ORDER BY runscore DESC NULLS last, firstname DESC, playerid ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
select Batting.playerID as playerid, nameFirst as firstname , (2 * sum(H2B) + 3 * sum(H3B) + 4 * sum(HR)) as runscore from Batting join People on Batting.playerID = People.playerID group by Batting.playerID, firstname order by runscore desc nulls last, firstname desc, playerid limit 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
WITH SCRTable as (SELECT playerID, SUM(2*(COALESCE(H2B,0))+3*(COALESCE(H3B,0))+4*(COALESCE(HR,0))) as runscore FROM Batting GROUP BY playerID) SELECT People.playerID, People.nameFirst, SCRTable.runscore FROM People INNER JOIN SCRTable On SCRTable.playerID = People.playerID ORDER BY SCRTable.runscore DESC, People.nameFirst DESC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
select playerID as playerid, (case when nameFirst is null then '' else nameFirst end) as firstname, 2*sum(case when H2B is null then 0 else H2B end)+3*sum(case when H3B is null then 0 else H3B end)+4*sum(case when HR is null then 0 else HR end) as runscore from people join batting using (playerID) group by playerid, firstname order by runscore desc, firstname desc, playerid asc limit 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
select   Batting.playerid, people.nameFirst as firstname, (4*COALESCE(sum(Batting.HR),0) + 3*COALESCE(sum(Batting.H3B), 0) + 2*COALESCE(sum(Batting.H2B), 0)) as runscore from Batting inner join people on people.playerid = Batting.playerid group by  Batting.playerid,people.nameFirst order by runscore desc  ,   people.nameFirst desc ,   Batting.playerid Limit 10 ;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT DISTINCT people.playerID as playerid, nameFirst as firstname , (2*COALESCE(SUM(Batting.H2B),0) + 3*COALESCE(SUM(Batting.H3B),0) + 4*COALESCE(SUM(Batting.HR),0)) as  runscore FROM People , Batting WHERE People.playerID = Batting.playerID GROUP BY people.playerID , firstname ORDER BY runscore desc , firstname desc ,playerid  asc LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
select people.playerid,people.nameFirst as firstname,y.runscore from (select playerid,sum(2*COALESCE(h2B,0)+3*COALESCE(h3B,0)+4*COALESCE(HR,0)) as runscore from batting group by playerid) as y inner join people on y.playerid=people.playerid order by runscore desc,firstname desc ,playerid limit 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
select distinct people.playerid, people.nameFirst as firstname, sum(bat.runscore) as runscore from people join ( select playerid, ((coalesce(batting.hr,0) * 4) + (coalesce(batting.h2b,0)* 2) + (coalesce(batting.h3b,0) * 3)) runscore from batting ) as bat on people.playerid = bat.playerid group by people.playerid, firstname order by runscore desc, firstname desc, playerid limit 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
select p.playerid as playerid, p.namefirst as firstname, runscore from people p join ( select playerid, sum( 2*COALESCE(H2B,0) + 3*COALESCE(H3B,0) + 4*COALESCE(HR,0) ) as runscore from batting group by playerid ) as t on t.playerid = p.playerid order by runscore DESC, firstname DESC, playerid LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT  People.playerID AS playerid, People.nameFirst AS firstname, SUM(2*coalesce(Batting.H2B,0) + 3*coalesce(Batting.H3B,0) + 4*coalesce(Batting.HR,0)) AS runscore FROM (People JOIN Batting ON (People.playerID = Batting.playerID)) GROUP BY People.playerID, People.nameFirst ORDER BY SUM(2*coalesce(Batting.H2B,0) + 3*coalesce(Batting.H3B,0) + 4*coalesce(Batting.HR,0)) DESC, People.nameFirst, People.playerID LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT People.playerid AS playerid, People.nameFirst AS firstname, COALESCE(Sum(2*(H2B)+3*(H3B)+4*(HR)), 0) AS runscore FROM People INNER JOIN Batting on People.playerid = Batting.playerid GROUP BY People.playerid, People.nameFirst ORDER BY runscore DESC, firstname ASC, playerid ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT People.playerID as playerid, nameFirst as firstname, 2*SUM(h2b) + 3*SUM(h3b) + 4*SUM(hr) as runscore FROM People JOIN Batting ON Batting.playerID = People.playerID WHERE h2b is NOT NULL AND h3b is NOT NULL and hr is not NULL GROUP BY People.playerID, nameFirst, nameLast ORDER BY runscore DESC, firstname DESC , playerid LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT people.playerID AS playerid, COALESCE(nameFirst, '') AS firstname, SUM(2*h2b+3*h3b+4*hr) AS runscore FROM people, ( SELECT playerID, COALESCE(h2b,0) AS h2b, COALESCE(h3b,0) AS h3b, COALESCE(hr,0) AS hr FROM batting ) AS t WHERE t.playerID = people.playerID GROUP BY people.playerID, firstname ORDER BY runscore DESC, firstname DESC, playerid ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
WITH batting_new(playerID , runscr) AS ( SELECT playerID, 2* COALESCE(SUM(H2B), 0) + 3 * COALESCE(SUM(H3B), 0) + 4* COALESCE(SUM(HR), 0) FROM Batting GROUP BY playerID ) SELECT People.playerID AS playerid , People.nameFirst AS firstname , batting_new.runscr AS runscore FROM People , batting_new WHERE People.playerID = batting_new.playerID ORDER BY batting_new.runscr DESC , People.nameFirst DESC , People.playerID ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
Select p.playerID as playerid , nameFirst as firstname , sum(2*(b.H2B)+ 3*(b.H3B) + 4*(b.HR) ) as runscore from people p join batting b on (p.playerID = b.playerID and H2B is not NULL and H3B is not NULL and HR is not NULL) group by p.playerID , nameFirst order by runscore desc ,firstname desc ,playerid desc limit 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
select C.playerid,D.nameFirst as firstname,C.runscore from (select B.playerid,SUM(B.runscore) as runscore from (select A.playerid,2*(case  when A.h2b is NULL then 0 else A.h2b end) + 3*(case  when A.h3b is NULL then 0 else A.h3b end)+ 4 *(case  when A.hr is NULL then 0 else A.hr end)as runscore from batting A ) B group by B.playerID order by runscore   desc limit 10) C inner join people D on C.playerid = D.playerid;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
with cte AS ( SELECT playerID, SUM(COALESCE(h2b,0)*2 + COALESCE(h3b,0)*3 + COALESCE(hr,0)*4) AS s FROM batting GROUP BY playerID ) SELECT cte.playerID, nameFirst, s FROM cte, People WHERE cte.playerID = people.playerID ORDER BY s DESC, nameFirst DESC, playerID LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
WITH FB1 AS ( SELECT 2*COALESCE(h2b,0)+3*COALESCE(h3b,0)+4*COALESCE(hr,0) as runscore , playerid FROM Batting ) , FB2 AS ( SELECT playerid , SUM(runscore) AS runscore FROM FB1 GROUP BY playerid ) SELECT People.playerid , COALESCE(nameFirst,'') as firstname , FB2.runscore FROM FB2 , People WHERE FB2.playerid=People.playerid ORDER BY runscore DESC , firstname DESC , playerid ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT People.playerid AS playerid,People.namefirst as firstname , t.runscore AS runscore FROM people,(SELECT playerid, sum(coalesce(h2b,0)*2+coalesce(h3b,0)*3 + coalesce(hr,0)*4) as runscore FROM batting group by playerid) as t WHERE people.playerid=t.playerid order by t.runscore DESC , People.namefirst DESC , t.playerid ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
select playerid, coalesce(namefirst,'') as firstname, sum(2*coalesce(h2b,0)+3*coalesce(h3b,0)+4*coalesce(hr,0)) as runscore from people natural join batting group by playerid, firstname order by runscore desc, firstname desc, playerid asc limit 10 ;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT p.playerID,p.nameFirst as firstname,2*SUM(b.H2B)+3*SUM(b.H3B)+4*SUM(b.HR) as runscore FROM People p,(SELECT playerid,COALESCE(b.H2B,0) as H2B,COALESCE(b.H3B,0) as H3B,COALESCE(b.HR,0) as HR FROM Batting b) b WHERE p.playerID=b.playerID GROUP BY p.playerid,p.namefirst ORDER BY runscore DESC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT b.playerid, nameFirst as firstname, SUM(2*CASE when h2b IS NULL then 0 else h2B end + 3*CASE when h3B IS NULL then 0 else h3B end + 4*CASE when HR IS NULL then 0 else HR end) AS runscore FROM batting AS b, people AS p WHERE b.playerid=p.playerid GROUP BY b.playerid,firstname ORDER BY runscore desc, firstname desc, playerid LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT t.playerid, nameFirst AS firstname, runscore FROM (SELECT playerid, SUM(runscore) AS runscore FROM (SELECT *, (2*h2b)+(3*h3b)+(4*hr) as runscore FROM batting) AS x WHERE runscore IS NOT NULL GROUP BY playerid ORDER BY SUM(runscore) DESC LIMIT 10) AS t JOIN people ON people.playerid = t.playerid ORDER BY runscore DESC, firstname DESC, playerid ASC;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT People.playerID AS playerid, (CASE WHEN nameFirst IS NULL THEN '' ELSE nameFirst END) AS firstname, (2 * SUM(CASE WHEN H2B IS NULL THEN 0 ELSE H2B END) + 3*SUM(CASE WHEN H3B IS NULL THEN 0 ELSE H3B END) + 4*SUM(CASE WHEN HR IS NULL THEN 0 ELSE HR END)) AS runscore FROM People JOIN Batting ON People.playerID = Batting.playerID GROUP BY People.playerID, nameFirst, nameLast ORDER BY runscore DESC, firstname DESC, playerid ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT batting.playerID, nameFirst AS firstname, SUM(2*(COALESCE(batting.H2B,0)) + 3*(COALESCE(batting.H3B,0)) + 4*(COALESCE(batting.HR,0))) AS runscore FROM batting,people WHERE people.playerID=batting.playerID GROUP BY batting.playerID, nameFirst, nameLast ORDER BY runscore DESC ,nameFirst DESC ,playerID ASC LIMiT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT People.playerID as playerid, People.nameFirst as firstname, coalesce(t.runscore, 0) as runscore FROM People LEFT OUTER JOIN ( SELECT playerID, 2 * SUM(coalesce(H2B, 0)) + 3 * SUM(coalesce(H3B, 0)) + 4 * SUM(coalesce(HR, 0)) as runscore FROM Batting GROUP BY playerID ORDER BY runscore DESC ) as t on People.playerID = t.playerID GROUP BY People.playerID, firstname, runscore ORDER BY runscore DESC, firstname DESC, People.playerID ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT People.playerid, People.nameFirst as firstname, 2 * SUM(h2b) + 3 * SUM(h3b) + 4 * SUM(hr) as runscore FROM People JOIN Batting ON People.playerid = Batting.playerid WHERE h2b IS NOT NULL AND h3b IS NOT NULL AND hr IS NOT NULL GROUP BY People.playerid, firstname ORDER BY runscore DESC, firstname DESC, People.playerid ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
WITH tableA AS ( SELECT playerid, (2*COALESCE(H2B,0)+3*COALESCE(H3B,0)+4*COALESCE(HR,0)) AS runscore FROM Batting GROUP BY playerid, H2B, H3B, HR ), tableB AS ( SELECT playerid, SUM(runscore) AS runscore FROM tableA GROUP BY playerid ) SELECT tableB.playerid, COALESCE(nameFirst,'') AS firstname, runscore FROM tableB, People WHERE tableB.playerid=People.playerid ORDER BY runscore DESC, firstname DESC, playerid ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT people.playerID AS playerid , people.nameFirst AS firstname , SUM(2*COALESCE(batting.H2B,0)+3*COALESCE(batting.H3B,0)+4*COALESCE(batting.HR,0)) AS runscore FROM people JOIN batting ON people.playerID = batting.playerID GROUP BY people.playerID,people.nameFirst ORDER BY SUM(2*COALESCE(batting.H2B,0)+3*COALESCE(batting.H3B,0)+4*COALESCE(batting.HR,0)) DESC,people.nameFirst DESC,people.playerID ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT Batting.playerID as playerid, nameFirst as firstname, SUM(2*COALESCE(H2B, 0) + 3*COALESCE(H3B, 0) + 4*COALESCE(HR, 0)) as runscore FROM Batting, People WHERE People.playerID = Batting.playerID GROUP BY Batting.playerID, nameFirst ORDER BY runscore DESC, nameFirst DESC, Batting.playerID LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
select u.playerid, coalesce(namefirst, '') as firstname, runscore from people join (select playerid, sum(runscore) as runscore from (select playerid,  2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0) as runscore from batting) as t group by playerid) as u on u.playerid = people.playerid order by runscore desc, firstname desc, playerid asc limit 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
Select people.playerid as playerid, Coalesce(namefirst,'') as firstname, 2*Coalesce(sum(h2b),0)+3*Coalesce(sum(h3b),0)+4*Coalesce(sum(hr),0) as runscore From people Join batting On people.playerid = batting.playerid Group By people.playerid, namefirst Order By runscore DESC, firstname ASC, people.playerid ASC Limit 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
WITH HT AS( SELECT playerID AS playerID , (2*COALESCE(SUM(H2B),0)+3*COALESCE(SUM(H3B),0)+4*COALESCE(SUM(HR),0)) as runscore FROM Batting GROUP BY Batting.playerID ) SELECT HT.playerID AS playerid, People.namefirst AS firstname, HT.runscore as runscore FROM HT JOIN People ON People.playerID = HT.playerID GROUP BY HT.playerid, People.namefirst, HT.runscore ORDER BY runscore DESC, firstname ASC, playerid ASC limit 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
with temp_2(playerID,s2) as ( Select playerID,2*Sum(H2B) as s2 From batting where H2B is not NULL group by playerID ), temp_3(playerID,s3) as ( Select playerID,3*Sum(H3B) as s3 From batting where H3B is not NULL group by playerID ), temp_4(playerID,s4) as ( Select playerID,4*Sum(HR) as s4 From batting where HR is not NULL group by playerID ), temp(playerID,runscore) as ( Select temp_2.playerID as playerID, s2+s3+s4 as runscore from temp_2,temp_3,temp_4 where temp_2.playerID=temp_3.playerID AND temp_3.playerID=temp_4.playerID ) Select playerID,nameFirst as firstname,runscore from people join temp using (playerID) Order by runscore DESC, firstname DESC, playerID ASC Limit 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT Batting.playerid,Coalesce(people.namefirst,'') as firstname,(2*coalesce(sum(H2B),0)+3*coalesce(sum(H3B),0)+4*coalesce(sum(HR),0)) as runscore FROM Batting join People on (Batting.playerID=People.playerID) GROUP BY Batting.playerid,people.namefirst ORDER BY (2*coalesce(sum(H2B),0)+3*coalesce(sum(H3B),0)+4*coalesce(sum(HR),0))  DESC,namefirst DESC,Batting.playerid limit 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT people.playerid, people.nameFirst firstname, 2*SUM(b.H2B)+3*SUM(b.H3B)+4*SUM(b.HR) runscore FROM people JOIN (SELECT playerid , COALESCE(H2B, 0) H2B, COALESCE(H3B, 0) H3B, COALESCE(HR,0) HR FROM batting) AS b ON (people.playerid = b.playerid ) GROUP BY people.playerid, firstname ORDER BY runscore DESC, firstname DESC, people.playerid LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT playerID,firstname,(2*A + 3*B + 4*C) as runscore FROM (SELECT People.playerID as playerID,People.namefirst as firstname,SUM(Batting.H2B) AS A,SUM(H3B) AS B,SUM(HR)AS C FROM People JOIN Batting ON People.playerID = Batting.PlayerID WHERE Batting.H2B>=0 AND Batting.H3B>=0 AND Batting.HR>=0 GROUP BY People.PlayerID,firstname) AS t GROUP BY playerID,firstname,t.A,t.B,t.C ORDER BY runscore DESC,firstname DESC, playerID ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT people.playerID AS playerid, COALESCE(people.nameFirst, '') AS firstname, 2*SUM(COALESCE(batting.H2B, 0)) + 3*SUM(COALESCE(batting.H3B, 0)) + 4*SUM(COALESCE(batting.HR, 0)) AS runscore FROM batting, people WHERE batting.playerID = people.playerID GROUP BY people.playerID, people.nameFirst ORDER BY runscore DESC, people.nameFirst DESC, people.playerID ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT People.playerID, COALESCE(nameFirst, '') AS firstname, SUM(2*COALESCE(H2B,0)+3*COALESCE(H3B,0)+4*COALESCE(HR,0)) AS runscore FROM People JOIN Batting ON People.playerID = Batting.playerID GROUP BY People.playerID, nameFirst ORDER BY runscore DESC, firstname DESC, playerID LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT playerid, namefirst,coalesce(sum(h2b),0)*2+coalesce(sum(h3b),0)*3+coalesce(sum(hr),0)*4 as runscore FROM people join batting using (playerid) GROUP BY playerid,namefirst ORDER BY runscore DESC, namefirst DESC, playerID LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
Select people.playerid as playerid, namefirst as firstname, runscore from people inner join ( select playerid, sum(2*h2b+3*h3b+4*hr) as runscore from batting group by playerid ) as t on (t.playerid = people.playerid) where runscore is not null order by runscore desc, firstname desc, playerid asc limit 10 ;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
select batting.playerid, (case when people.nameFirst IS NULL then '' else people.nameFirst end) as firstname, 2*sum(case when h2b IS NULL then 0 else h2b end) + 3*sum(case when h3b IS NULL then 0 else h3b end) + 4*sum(case when hr IS NULL then 0 else hr end) as runscore from batting join people on people.playerid = batting.playerid group by batting.playerid, firstname order by runscore desc, firstname desc, batting.playerid limit 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT Batting.playerID,People.nameFirst AS firstname, SUM(4*COALESCE(Batting.HR,0)+2*COALESCE(Batting.H2B,0)+3*COALESCE(Batting.H3B,0)) AS runscore FROM Batting INNER JOIN People ON Batting.playerID=People.playerID GROUP BY Batting.playerID,firstname ORDER BY runscore DESC,firstname DESC,playerID LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
select Batting.playerid, namefirst as firstname, sum((2*coalesce(h2b, 0) + 3*coalesce(h3b, 0) + 4*coalesce(hr, 0))) as runscore from Batting, People where Batting.playerid = People.playerid group by Batting.playerid, namefirst order by runscore desc, firstname desc, playerid limit 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
select People.playerID as playerid, People.nameFirst as firstname, runscore from People, ( select playerID, (coalesce(sum(Batting.H2B),0) * 2 + coalesce(sum(Batting.H3B),0) * 3 + coalesce(sum(Batting.HR),0) * 4) as runscore from Batting group by playerID order by runscore desc limit 10 ) as PlayerRunScore where PlayerRunScore.playerID = People.playerID order by runscore desc, firstname desc, playerid;
