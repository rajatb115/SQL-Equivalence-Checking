with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
select people.playerID, nameFirst as firstname, sum(R) as runscore from Batting, People where People.playerID = Batting.playerID group by people.playerID, firstname order by runscore DESC NULLS LAST, firstname DESC, people.playerID ASC limit 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT player_id, family_name, given_name, count_tournaments FROM players WHERE count_tournaments =4;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT b.playerID as playerid, p.nameFirst as firstname, SUM(COALESCE(b.H2B,0) * 2 + COALESCE(b.H3B,0) * 3 + COALESCE(b.HR,0) * 4) AS runscore FROM Batting b INNER JOIN People p ON b.playerID=p.pl ayerID GROUP BY b.playerid, firstname ORDER BY runscore DESC, firstname DESC, b.playerid LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
select t.playerid,people.namefirst,runscore from (select playerid, max(2*h2b+3*h3b+4*hr)as runscore from batting group by playerid)as t , people where t.playerid=people.playerid and runscore is not null order by runscore desc, people.namefirst desc , t.playerid asc limit 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT people.playerid,namefirst AS firstname,(COALESCE(h2b,0)*2+COALESCE(h3b,0)*3+COALESCE(hr,0)*4) AS runscore FROM people JOIN batting ON people.playerid=batting.playerid GROUP BY people.playerid,namefirst,h2b,h3b,hr ORDER BY runscore DESC, namefirst DESC,people.playerid ASC LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
SELECT batting.playerid,people.nameFIRST  as firstname,(2*coalesce(H2b,0) + 3*coalesce(H3B,0) + 4*coalesce(hr,0)) as runscore FROM batting,people where people.playerid=batting.playerid order by runscore desc,firstname desc,playerID LIMIT 10;
with result as (select sum(2*coalesce(h2b,0) + 3*coalesce(h3b,0) + 4*coalesce(hr,0)) as runscore, playerid from batting GROUP BY playerid ORDER BY runscore desc) select result.playerid, coalesce(people.namefirst,'') as firstname, result.runscore from result join people on result.playerid = people.playerid order by result.runscore desc, firstname desc, playerid asc limit 10;
select t.playerID as playerid , nameFirst as firstname , nameLast as lastname, t.runscore  from people , (select 2*sum(H2B)+3*sum(H3B)+4*sum(HR) as runscore , playerID from (select * from Batting where H2B+H3B+HR>0) as foo  group by playerID order by runscore desc fetch first 10 rows only) as t where people.playerID=t.playerID order by runscore desc , firstname desc , playerid asc ;
