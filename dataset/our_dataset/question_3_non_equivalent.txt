with result as (select playerid, sum(coalesce(pointsWon,0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid), player_name_table as (select playerid, namefirst, namelast, coalesce(namefirst, '') || CASE WHEN (namefirst || namelast) is not NULL THEN ' ' ELSE '' END || coalesce(namelast, '') as playername from people) select result.playerid, PN.playername, result.total_points from result join player_name_table PN on result.playerid = PN.playerid order by total_points desc, playerid asc;
SELECT people.playerid, COALESCE((namefirst || ' ' || namelast),namefirst,namelast) AS playername, SUM(COALESCE(pointsWon, 0)) AS total_points FROM people JOIN awardssharemanagers ON people.playerid = awardssharemanagers.playerid WHERE yearid >= 2000 GROUP BY people.playerid, playername ORDER BY total_points DESC, playerid ASC;
with result as (select playerid, sum(coalesce(pointsWon,0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid), player_name_table as (select playerid, namefirst, namelast, coalesce(namefirst, '') || CASE WHEN (namefirst || namelast) is not NULL THEN ' ' ELSE '' END || coalesce(namelast, '') as playername from people) select result.playerid, PN.playername, result.total_points from result join player_name_table PN on result.playerid = PN.playerid order by total_points desc, playerid asc;
SELECT t1.playerID AS playerid, People.nameFirst || ' '|| People.nameLast   AS playername, t1.total_points  FROM People JOIN (SELECT t2.playerID , SUM(t2.pointsWon) AS total_points FROM (SELECT playerID,  (CASE WHEN pointsWon IS NULL THEN 0 WHEN (pointsWon >=0  AND yearID < 2000) THEN 0  ELSE pointsWon END) AS pointsWon FROM AwardsSharePlayers) AS t2 GROUP BY t2.playerID ) AS t1 ON t1.playerID = People.playerID ORDER BY total_points DESC, playerid;
with result as (select playerid, sum(coalesce(pointsWon,0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid), player_name_table as (select playerid, namefirst, namelast, coalesce(namefirst, '') || CASE WHEN (namefirst || namelast) is not NULL THEN ' ' ELSE '' END || coalesce(namelast, '') as playername from people) select result.playerid, PN.playername, result.total_points from result join player_name_table PN on result.playerid = PN.playerid order by total_points desc, playerid asc;
SELECT People.playerID AS playerid, (CASE WHEN nameFirst IS NULL AND nameLast IS NULL THEN '' WHEN nameFirst IS NULL THEN nameLast WHEN nameLast IS NULL THEN nameFirst ELSE nameFirst || ' ' || nameLast END) AS playername, COALESCE(total_points, 0) FROM People LEFT JOIN ( SELECT playerID, COALESCE(SUM(pointsWon), 0) AS total_points FROM AwardsSharePlayers WHERE yearID >= 2000 GROUP BY playerID) AS t ON People.playerID = t.playerID ORDER BY COALESCE(total_points, 0) DESC, playerid;
with result as (select playerid, sum(coalesce(pointsWon,0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid), player_name_table as (select playerid, namefirst, namelast, coalesce(namefirst, '') || CASE WHEN (namefirst || namelast) is not NULL THEN ' ' ELSE '' END || coalesce(namelast, '') as playername from people) select result.playerid, PN.playername, result.total_points from result join player_name_table PN on result.playerid = PN.playerid order by total_points desc, playerid asc;
select awardsshareplayers.playerID as playerid, case when nameFirst is null then coalesce(namelast,'') else namefirst || ' ' || coalesce(nameLast,'') end as playername, case when awardsshareplayers.playerid in (select playerid from awardsshareplayers where yearid>=2000) then (select sum(pointswon) from awardsshareplayers as a where awardsshareplayers.playerid=a.playerid and yearid>=2000) else 0 end as total_points from people, awardsshareplayers where people.playerid = awardsshareplayers.playerid group by awardsshareplayers.playerid, playername order by total_points desc, playerid;
with result as (select playerid, sum(coalesce(pointsWon,0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid), player_name_table as (select playerid, namefirst, namelast, coalesce(namefirst, '') || CASE WHEN (namefirst || namelast) is not NULL THEN ' ' ELSE '' END || coalesce(namelast, '') as playername from people) select result.playerid, PN.playername, result.total_points from result join player_name_table PN on result.playerid = PN.playerid order by total_points desc, playerid asc;
with t as ( select people.playerid, coalesce(nameFirst, ' ') || ' ' || coalesce(nameLast, ' ') as playername, pointswon from people, awardsshareplayers where people.playerid = awardsshareplayers.playerid and yearid >= 2000 ) select playerid, playername ,sum(pointswon) as total_points from t group by playerid, playername order by total_points desc;
with result as (select playerid, sum(coalesce(pointsWon,0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid), player_name_table as (select playerid, namefirst, namelast, coalesce(namefirst, '') || CASE WHEN (namefirst || namelast) is not NULL THEN ' ' ELSE '' END || coalesce(namelast, '') as playername from people) select result.playerid, PN.playername, result.total_points from result join player_name_table PN on result.playerid = PN.playerid order by total_points desc, playerid asc;
select People.playerID, (nameFirst || ' ' || nameLast) as playername, sum(R) as total_points from Batting, People where People.playerID = Batting.playerID and yearID>=2000 group by People.playerID, nameFirst order by total_points DESC, People.playerID ASC;
with result as (select playerid, sum(coalesce(pointsWon,0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid), player_name_table as (select playerid, namefirst, namelast, coalesce(namefirst, '') || CASE WHEN (namefirst || namelast) is not NULL THEN ' ' ELSE '' END || coalesce(namelast, '') as playername from people) select result.playerid, PN.playername, result.total_points from result join player_name_table PN on result.playerid = PN.playerid order by total_points desc, playerid asc;
SELECT COUNT(*) FROM (matches JOIN teams ON matches.home_team_id = teams.team_id OR matches.away_team_id = teams.team_id) WHERE teams.team_name = 'Croatia' AND draw = TRUE;
with result as (select playerid, sum(coalesce(pointsWon,0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid), player_name_table as (select playerid, namefirst, namelast, coalesce(namefirst, '') || CASE WHEN (namefirst || namelast) is not NULL THEN ' ' ELSE '' END || coalesce(namelast, '') as playername from people) select result.playerid, PN.playername, result.total_points from result join player_name_table PN on result.playerid = PN.playerid order by total_points desc, playerid asc;
WITH Current AS ( SELECT AwardsShareManagers.playerID AS playerID, AwardsShareManagers.yearID AS yearID, AwardsShareManagers.pointsWon AS pointsWon FROM AwardsShareManagers WHERE AwardsShareManagers.yearID >= 2000 UNION SELECT AwardsSharePlayers.playerID AS playerID, AwardsSharePlayers.yearID AS yearID, AwardsSharePlayers.pointsWon AS pointsWon FROM AwardsSharePlayers WHERE AwardsSharePlayers.yearID >=2000 ) SELECT Current.playerID AS playerID, (People.nameFirst || ' ' || People.nameLast)  AS playername, SUM(COALESCE(Current.pointsWon,0)) AS total_points FROM Current INNER JOIN People ON Current.playerID = People.playerID GROUP By Current.playerID, People.nameFirst, People.nameLast Order By total_points DESC, playerid ASC;
with result as (select playerid, sum(coalesce(pointsWon,0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid), player_name_table as (select playerid, namefirst, namelast, coalesce(namefirst, '') || CASE WHEN (namefirst || namelast) is not NULL THEN ' ' ELSE '' END || coalesce(namelast, '') as playername from people) select result.playerid, PN.playername, result.total_points from result join player_name_table PN on result.playerid = PN.playerid order by total_points desc, playerid asc;
SELECT people.playerid,(Coalesce(nameFirst,'') || ' ' || Coalesce(nameLast,'')) as playername,SUM(Coalesce(pointsWon,0)) as total_points FROM people join AwardsSharePlayers on people.playerid=AwardsSharePlayers.playerid WHERE AwardsSharePlayers.yearid>=2000 GROUP BY people.playerid,nm ORDER BY total_points DESC, playerid Asc;
with result as (select playerid, sum(coalesce(pointsWon,0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid), player_name_table as (select playerid, namefirst, namelast, coalesce(namefirst, '') || CASE WHEN (namefirst || namelast) is not NULL THEN ' ' ELSE '' END || coalesce(namelast, '') as playername from people) select result.playerid, PN.playername, result.total_points from result join player_name_table PN on result.playerid = PN.playerid order by total_points desc, playerid asc;
WITH after(playerid, points) AS ( SELECT DISTINCT ON (playerid) playerid, SUM(pointswon) FROM AwardsSharePlayers WHERE yearid >= 2000 GROUP BY playerid ), after_2(players, points) AS ( SELECT playerid, points FROM after UNION SELECT playerid, 0 as points FROM AwardsSharePlayers WHERE playerid NOT IN (SELECT playerid from after) ) SELECT players as playerid, (namefirst || ' ' || namelast) as playername, points as total_points FROM People JOIN after_2 ON People.playerid = after_2.players ORDER BY points DESC, playerid;
with result as (select playerid, sum(coalesce(pointsWon,0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid), player_name_table as (select playerid, namefirst, namelast, coalesce(namefirst, '') || CASE WHEN (namefirst || namelast) is not NULL THEN ' ' ELSE '' END || coalesce(namelast, '') as playername from people) select result.playerid, PN.playername, result.total_points from result join player_name_table PN on result.playerid = PN.playerid order by total_points desc, playerid asc;
SELECT people.playerid AS playerid, COALESCE(nameFirst,'')||(case when (nameFirst IS NULL OR nameLast IS NULL) then '' else ' ' end)||COALESCE(nameLast,'') AS playername, COALESCE(SUM(pointsWon),0) AS total_points FROM people LEFT JOIN AwardsSharePlayers ON people.playerid=AwardsSharePlayers.playerid AND yearId>=2000 GROUP BY people.playerid,nameFirst,nameLast ORDER BY total_points DESC, playerid;
with result as (select playerid, sum(coalesce(pointsWon,0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid), player_name_table as (select playerid, namefirst, namelast, coalesce(namefirst, '') || CASE WHEN (namefirst || namelast) is not NULL THEN ' ' ELSE '' END || coalesce(namelast, '') as playername from people) select result.playerid, PN.playername, result.total_points from result join player_name_table PN on result.playerid = PN.playerid order by total_points desc, playerid asc;
SELECT People.playerID as playerid, COALESCE(nameFirst || ' ' || nameLast, nameFirst, nameLast, '') as playername, SUM(COALESCE(pointsWon, 0)) as total_points FROM People LEFT JOIN (SELECT * FROM AwardsSharePlayers WHERE yearID >= 2000) as AwardsSharePlayers ON People.playerID = AwardsSharePlayers.playerID GROUP BY People.playerID, nameFirst, nameLast ORDER BY total_points DESC, playerid ;
with result as (select playerid, sum(coalesce(pointsWon,0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid), player_name_table as (select playerid, namefirst, namelast, coalesce(namefirst, '') || CASE WHEN (namefirst || namelast) is not NULL THEN ' ' ELSE '' END || coalesce(namelast, '') as playername from people) select result.playerid, PN.playername, result.total_points from result join player_name_table PN on result.playerid = PN.playerid order by total_points desc, playerid asc;
SELECT p.playerid AS playerid, COALESCE(p.nameFirst || ' ' || p.nameLast,' ') AS playername, SUM(asp.pointsWon) AS total_points FROM People p INNER JOIN AwardsSharePlayers asp ON p.playerid=asp.pl ayerid GROUP BY p.playerid, playername ORDER by total_points DESC, p.playerid;
with result as (select playerid, sum(coalesce(pointsWon,0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid), player_name_table as (select playerid, namefirst, namelast, coalesce(namefirst, '') || CASE WHEN (namefirst || namelast) is not NULL THEN ' ' ELSE '' END || coalesce(namelast, '') as playername from people) select result.playerid, PN.playername, result.total_points from result join player_name_table PN on result.playerid = PN.playerid order by total_points desc, playerid asc;
SELECT awardsshareplayers.playerID AS playerid,COALESCE(people.nameFirst,'')||COALESCE(people.nameLast,'') AS playername,SUM(COALESCE(awardsshareplayers.pointswon,0)) AS total_points FROM awardsshareplayers INNER JOIN people ON awardsshareplayers.playerID=people.playerID WHERE awardsshareplayers.yearID>=2000 GROUP BY awardsshareplayers.playerID,playername  ORDER BY total_points DESC,playerid;
with result as (select playerid, sum(coalesce(pointsWon,0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid), player_name_table as (select playerid, namefirst, namelast, coalesce(namefirst, '') || CASE WHEN (namefirst || namelast) is not NULL THEN ' ' ELSE '' END || coalesce(namelast, '') as playername from people) select result.playerid, PN.playername, result.total_points from result join player_name_table PN on result.playerid = PN.playerid order by total_points desc, playerid asc;
with ne as(SELECT * FROM AwardsSharePlayers where  AwardsSharePlayers.pointswon is not null and AwardsSharePlayers.yearid>=2000) SELECT newtable.ID as playerid,people.nameGiven as playername,newtable.SU   as total_points FROM (SELECT ne.playerID,SUM(ne.pointswon) AS total FROM ne GROUP BY ne.playerID) as newtable(ID,SU) INNER JOIN people  ON people.playerID = newtable.ID order by total_points DESC,playerid ASC
with result as (select playerid, sum(coalesce(pointsWon,0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid), player_name_table as (select playerid, namefirst, namelast, coalesce(namefirst, '') || CASE WHEN (namefirst || namelast) is not NULL THEN ' ' ELSE '' END || coalesce(namelast, '') as playername from people) select result.playerid, PN.playername, result.total_points from result join player_name_table PN on result.playerid = PN.playerid order by total_points desc, playerid asc;
SELECT People.playerID,(People.nameFirst || ' '|| People.nameLast) AS playername,c.total_points FROM People INNER JOIN (SELECT playerID,SUM(COALESCE(pointsWon,0)) as total_points FROM AwardsSharePlayers WHERE yearID>1999 GROUP BY playerID) AS c ON People.playerID=c.playerID ORDER BY c.total_points DESC;
with result as (select playerid, sum(coalesce(pointsWon,0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid), player_name_table as (select playerid, namefirst, namelast, coalesce(namefirst, '') || CASE WHEN (namefirst || namelast) is not NULL THEN ' ' ELSE '' END || coalesce(namelast, '') as playername from people) select result.playerid, PN.playername, result.total_points from result join player_name_table PN on result.playerid = PN.playerid order by total_points desc, playerid asc;
select playerID as playerid,  case when nameFirst is null and nameLast is null then null when nameFirst is null then nameLast when nameLast is null then nameFirst else nameFirst || ' ' || nameLast  end as playername, greatest((select sum(pointsWon) from awardsshareplayers where awardsshareplayers.playerID = people.playerID and yearID > 1999), 0) as total_points from people order by total_points desc, playerid asc;
with result as (select playerid, sum(coalesce(pointsWon,0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid), player_name_table as (select playerid, namefirst, namelast, coalesce(namefirst, '') || CASE WHEN (namefirst || namelast) is not NULL THEN ' ' ELSE '' END || coalesce(namelast, '') as playername from people) select result.playerid, PN.playername, result.total_points from result join player_name_table PN on result.playerid = PN.playerid order by total_points desc, playerid asc;
SELECT temp.playerid, COALESCE(nameFirst,'') || ' ' || COALESCE(nameLast,'') as playername, temp.total_points FROM People JOIN ( SELECT playerid, SUM(COALESCE(pointsWon,0)) as total_points FROM AwardsSharePlayers WHERE yearID >= 2000 GROUP By playerid ) AS temp ON temp.playerid = People.playerid ORDER BY total_points DESC, playerid LIMIT 10;
with result as (select playerid, sum(coalesce(pointsWon,0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid), player_name_table as (select playerid, namefirst, namelast, coalesce(namefirst, '') || CASE WHEN (namefirst || namelast) is not NULL THEN ' ' ELSE '' END || coalesce(namelast, '') as playername from people) select result.playerid, PN.playername, result.total_points from result join player_name_table PN on result.playerid = PN.playerid order by total_points desc, playerid asc;
SELECT playerid, MAX(total_points) as total_points FROM ( SELECT playerid, (0) AS total_points FROM people UNION all SELECT playerid, SUM(pointswon) as total_points FROM AwardsSharePlayers WHERE yearID > 1999 GROUP BY playerid ) AS subquery GROUP BY playerid ORDER BY total_points DESC,playerid ASC;
with result as (select playerid, sum(coalesce(pointsWon,0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid), player_name_table as (select playerid, namefirst, namelast, coalesce(namefirst, '') || CASE WHEN (namefirst || namelast) is not NULL THEN ' ' ELSE '' END || coalesce(namelast, '') as playername from people) select result.playerid, PN.playername, result.total_points from result join player_name_table PN on result.playerid = PN.playerid order by total_points desc, playerid asc;
WITH total_points_table AS ( SELECT playerid,  SUM(COALESCE(CASE WHEN yearid>1999 THEN pointswon ELSE 0 END, 0)) AS total_points FROM AwardsSharePlayers GROUP BY playerid ) SELECT people.playerid, RTRIM(COALESCE(nameFirst || ' ', '') || COALESCE(nameLast, '')) AS playername, total_points FROM total_points_table JOIN people on people.playerid = total_points_table.playerid ORDER BY total_points DESC, playerid ASC;
with result as (select playerid, sum(coalesce(pointsWon,0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid), player_name_table as (select playerid, namefirst, namelast, coalesce(namefirst, '') || CASE WHEN (namefirst || namelast) is not NULL THEN ' ' ELSE '' END || coalesce(namelast, '') as playername from people) select result.playerid, PN.playername, result.total_points from result join player_name_table PN on result.playerid = PN.playerid order by total_points desc, playerid asc;
WITH TPTable as (SELECT playerID, SUM(COALESCE(pointsWon,0)) as total_points FROM AwardsSharePlayers WHERE yearID>1999 GROUP BY playerID) SELECT People.playerID, (People.nameFirst||' '||People.nameLast) as playername, TPTable.total_points FROM People INNER JOIN TPTable ON TPTable.playerID = People.playerID ORDER BY TPTable.total_points DESC
with result as (select playerid, sum(coalesce(pointsWon,0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid), player_name_table as (select playerid, namefirst, namelast, coalesce(namefirst, '') || CASE WHEN (namefirst || namelast) is not NULL THEN ' ' ELSE '' END || coalesce(namelast, '') as playername from people) select result.playerid, PN.playername, result.total_points from result join player_name_table PN on result.playerid = PN.playerid order by total_points desc, playerid asc;
select people.playerid,people.nameGiven as playername ,y.total_points from(select playerid ,sum(coalesce(pointswon,0.0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid) as y inner join people on people.playerid=y.playerid order by total_points desc,playerid asc;
with result as (select playerid, sum(coalesce(pointsWon,0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid), player_name_table as (select playerid, namefirst, namelast, coalesce(namefirst, '') || CASE WHEN (namefirst || namelast) is not NULL THEN ' ' ELSE '' END || coalesce(namelast, '') as playername from people) select result.playerid, PN.playername, result.total_points from result join player_name_table PN on result.playerid = PN.playerid order by total_points desc, playerid asc;
SELECT p.playerID,(CASE WHEN p.namefirst IS NULL AND p.namelast IS NULL THEN '' WHEN p.nameFirst is NULL AND p.namelast IS NOT NULL THEN p.namelast WHEN p.namefirst IS NOT NULL AND p.namelast is NULL then p.namefirst  ELSE p.namefirst || ' ' || p.nameLast END) as playername,SUM(a.pointsWon) as total_points FROM People p,AwardsSharePlayers a WHERE p.playerID=a.playerID AND yearID>=2000 GROUP BY p.playerID ORDER BY total_points DESC,p.playerID;
with result as (select playerid, sum(coalesce(pointsWon,0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid), player_name_table as (select playerid, namefirst, namelast, coalesce(namefirst, '') || CASE WHEN (namefirst || namelast) is not NULL THEN ' ' ELSE '' END || coalesce(namelast, '') as playername from people) select result.playerid, PN.playername, result.total_points from result join player_name_table PN on result.playerid = PN.playerid order by total_points desc, playerid asc;
SELECT People.playerID as playerid, (CASE WHEN nameFirst IS NULL AND nameLast IS NULL THEN '' WHEN nameFirst is NULL THEN nameLast WHEN nameLast IS NULL THEN nameFirst ELSE nameFirst || ' ' || nameLast END) AS playername, SUM(COALESCE(pointsWon, 0)) AS total_points FROM People LEFT JOIN (SELECT * FROM AwardsSharePlayers WHERE yearID >= 2000 ) AS t1 ON People.playerID = t1.playerID GROUP BY People.playerID, playername ORDER BY total_points DESC, playerid ASC;
with result as (select playerid, sum(coalesce(pointsWon,0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid), player_name_table as (select playerid, namefirst, namelast, coalesce(namefirst, '') || CASE WHEN (namefirst || namelast) is not NULL THEN ' ' ELSE '' END || coalesce(namelast, '') as playername from people) select result.playerid, PN.playername, result.total_points from result join player_name_table PN on result.playerid = PN.playerid order by total_points desc, playerid asc;
SELECT People.playerID as playerid, coalesce(People.nameFirst, '') || coalesce(People.nameLast, '') as playername, coalesce(t.total_points, 0) as total_points FROM People LEFT OUTER JOIN ( SELECT playerID, SUM(coalesce(pointsWon, 0)) as total_points FROM AwardsSharePlayers WHERE yearID >= 2000 GROUP BY playerID ) as t on People.playerID = t.playerID GROUP BY People.playerID, playername, t.total_points ORDER BY total_points DESC, People.playerID ASC;
with result as (select playerid, sum(coalesce(pointsWon,0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid), player_name_table as (select playerid, namefirst, namelast, coalesce(namefirst, '') || CASE WHEN (namefirst || namelast) is not NULL THEN ' ' ELSE '' END || coalesce(namelast, '') as playername from people) select result.playerid, PN.playername, result.total_points from result join player_name_table PN on result.playerid = PN.playerid order by total_points desc, playerid asc;
SELECT People.playerid, People.nameFirst as firstname, People.nameLast as lastname, SUM(AwardsSharePlayers.pointsWon) as total_points FROM People JOIN AwardsSharePlayers ON People.playerid = AwardsSharePlayers.playerid WHERE AwardsSharePlayers.yearID >= 2000 GROUP BY People.playerid, firstname, lastname ORDER BY total_points DESC, playerid ASC;
with result as (select playerid, sum(coalesce(pointsWon,0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid), player_name_table as (select playerid, namefirst, namelast, coalesce(namefirst, '') || CASE WHEN (namefirst || namelast) is not NULL THEN ' ' ELSE '' END || coalesce(namelast, '') as playername from people) select result.playerid, PN.playername, result.total_points from result join player_name_table PN on result.playerid = PN.playerid order by total_points desc, playerid asc;
drop view if exists p1; create temp view p1 as select people.playerid, (case when namefirst is NULL then coalesce(namelast, '') when namelast is NULL then coalesce(namefirst,'') else namefirst || ' ' || namelast end) as playername, coalesce(sum, 0) as total_points from people join (select * from (select distinct playerid from awardsshareplayers) as v left join (select playerid as pid, sum(coalesce(pointswon, 0)) from awardsshareplayers where yearid >= 2000 group by playerid) as u on u.pid = v.playerid) as t on t.playerid = people.playerid; select * from p1 order by total_points desc, playerid; drop view p1;
with result as (select playerid, sum(coalesce(pointsWon,0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid), player_name_table as (select playerid, namefirst, namelast, coalesce(namefirst, '') || CASE WHEN (namefirst || namelast) is not NULL THEN ' ' ELSE '' END || coalesce(namelast, '') as playername from people) select result.playerid, PN.playername, result.total_points from result join player_name_table PN on result.playerid = PN.playerid order by total_points desc, playerid asc;
SELECT People.playerID as playerid, (COALESCE(People.namefirst || ' ','') ||COALESCE(People.namelast||' ','')) as playername,SUM(pointsWon) AS total_points FROM People JOIN AwardsSharePlayers ON People.playerID=AwardsSharePlayers.playerID WHERE yearID>=2000 GROUP BY People.playerid,playername ORDER BY total_points DESC, playerid ASC;
with result as (select playerid, sum(coalesce(pointsWon,0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid), player_name_table as (select playerid, namefirst, namelast, coalesce(namefirst, '') || CASE WHEN (namefirst || namelast) is not NULL THEN ' ' ELSE '' END || coalesce(namelast, '') as playername from people) select result.playerid, PN.playername, result.total_points from result join player_name_table PN on result.playerid = PN.playerid order by total_points desc, playerid asc;
SELECT people.playerID AS playerid, RTRIM((CASE WHEN people.nameFirst IS NOT NULL THEN people.nameFirst || ' ' ELSE '' END) || COALESCE(people.nameLast, '')) AS playername, SUM(COALESCE(AwardsSharePlayers.pointsWon, 0)) as total_points FROM people LEFT JOIN AwardsSharePlayers ON (AwardsSharePlayers.playerID = people.playerID AND AwardsSharePlayers.yearID >= 2000) GROUP BY people.playerID, playername ORDER BY total_points DESC, people.playerid ASC;
with result as (select playerid, sum(coalesce(pointsWon,0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid), player_name_table as (select playerid, namefirst, namelast, coalesce(namefirst, '') || CASE WHEN (namefirst || namelast) is not NULL THEN ' ' ELSE '' END || coalesce(namelast, '') as playername from people) select result.playerid, PN.playername, result.total_points from result join player_name_table PN on result.playerid = PN.playerid order by total_points desc, playerid asc;
SELECT awardsshareplayers.playerid, case when namefirst is null and namelast is null then '' else coalesce(namefirst,'')||' '||coalesce(namelast,'') end as playername , coalesce(sum(pointswon),0) as total_points FROM awardsshareplayers,people WHERE awardsshareplayers.playerID=people.playerid and yearid>=2000 GROUP BY awardsshareplayers.playerID, playername ORDER BY total_points DESC, playerid LIMIT 10;
with result as (select playerid, sum(coalesce(pointsWon,0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid), player_name_table as (select playerid, namefirst, namelast, coalesce(namefirst, '') || CASE WHEN (namefirst || namelast) is not NULL THEN ' ' ELSE '' END || coalesce(namelast, '') as playername from people) select result.playerid, PN.playername, result.total_points from result join player_name_table PN on result.playerid = PN.playerid order by total_points desc, playerid asc;
select people.playerid, COALESCE(people.nameFirst || ' ' || people.nameLast, people.nameFirst, people.nameLast, '') as playername, sum(case when pointswon IS NULL then 0 else pointswon end) as total_points from people left join AwardsSharePlayers on AwardsSharePlayers.playerid = people.playerid and AwardsSharePlayers.yearid >= 2000 group by people.playerid, playername order by total_points desc, people.playerid;
with result as (select playerid, sum(coalesce(pointsWon,0)) as total_points from awardsshareplayers where yearid>=2000 group by playerid), player_name_table as (select playerid, namefirst, namelast, coalesce(namefirst, '') || CASE WHEN (namefirst || namelast) is not NULL THEN ' ' ELSE '' END || coalesce(namelast, '') as playername from people) select result.playerid, PN.playername, result.total_points from result join player_name_table PN on result.playerid = PN.playerid order by total_points desc, playerid asc;
select People.playerID as playerID , CONCAT(nameFirst ,' ', nameLast) as playername ,t_1.total_points from People ,(select sum(t.pointsWon) as total_points ,t.playerID  from  People , (select * from AwardsSharePlayers where pointsWon>0 and yearID>=2000) as t where People.playerID = t.playerID group by t.playerID  order by total_points desc , t.playerID asc fetch first 10 rows only) as t_1 where People.playerID = t_1.playerID ;
