with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT people.playerid, namefirst AS firstname, namelast AS lastname, COALESCE(LPAD(CAST(birthyear AS VARCHAR(4)), 4, '0') || '-' || LPAD(CAST(birthmonth AS VARCHAR(2)), 2, '0') || '-' || LPAD(CAST(birthday AS VARCHAR(2)), 2, '0'), '') AS date_of_birth, COUNT(DISTINCT t.yearid) AS num_seasons FROM people JOIN ( (SELECT playerid, yearid FROM batting AS t1) UNION (SELECT playerid, yearid FROM pitching AS t2) UNION (SELECT playerid, yearid FROM fielding AS t3) ) AS t ON people.playerid = t.playerid GROUP BY people.playerid, namefirst, namelast, date_of_birth ORDER BY num_seasons DESC, people.playerid, firstname, lastname, date_of_birth;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
with t1 as ( select playerID, yearID from batting UNION select playerID, yearID from pitching UNION select playerID, yearID from Fielding ), t2 as ( select playerID, count(distinct yearID) as num_seasons from t1 group by playerID ) select t2.playerID as playerid, nameFirst as firstname, nameLast as lastname, case when birthYear is NULL or birthMonth is NULL or birthDay is NULL then '' else birthYear || '-' || lpad(birthmonth::text, 2, '0') || '-' || lpad(birthDay::text, 2, '0') end as date_of_birth, num_seasons from t2, people where t2.playerID = people.playerID order by num_seasons desc, playerid asc, firstname asc, lastname asc, date_of_birth asc;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT playerid, namefirst AS firstname, namelast AS lastname, ( birthyear || '-' || birthmonth || '-' || birthday ) AS date_of_birth, ( SELECT COUNT(*) FROM ( SELECT DISTINCT yearid FROM batting WHERE batting.playerid = people.playerid UNION SELECT DISTINCT yearid FROM pitching WHERE pitching.playerid = people.playerid UNION SELECT DISTINCT yearid FROM fielding WHERE fielding.playerid = people.playerid ) AS p ) AS num_seasons FROM people ORDER BY num_seasons DESC, playerid ASC, firstname ASC, lastname ASC, date_of_birth ASC; ;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT t2.playerID AS playerid, People.nameFirst AS firstname , People.nameLast AS lastname, (CASE WHEN People.birthYear IS NOT NULL AND People.birthMonth IS NOT NULL AND People.birthDay IS NOT NULL THEN CAST(People.birthYear AS varchar(10)) || '-' || CAST(People.birthMonth AS varchar(10)) || '-' || CAST(People.birthDay AS varchar(10)) ELSE NULL END) AS date_of_birth ,t2.num_seasons FROM People JOIN ( SELECT playerID, COUNT(DISTINCT(yearID)) AS num_seasons FROM (SELECT playerID , yearID FROM Batting UNION ALL SELECT playerID, yearID FROM Pitching UNION ALL SELECT playerID, yearID FROM Fielding ) AS t1 GROUP BY playerID ORDER BY num_seasons DESC LIMIT 10) AS t2 ON t2.playerID = People.playerID ORDER BY num_seasons DESC, playerid, firstname,lastname,date_of_birth ;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
select people.playerID as playerid,nameFirst as firstname,nameLast as lastname,(case when ((birthYear is null) or (birthMonth is null) or (birthDay is null)) then '' else (to_char(birthYear,'9999') || '-' || case when (birthMonth/10)>=1 then '' || birthMonth else '0' || birthMonth end || '-' || case when (birthDay/10)>=1 then '' || birthDay else '0' || birthDay end ) end) as date_of_birth, num_seasons from people,( select playerID,count(playerID) as num_seasons from ( (select distinct playerID,yearID FROM batting) union (select distinct playerID,yearID from Pitching) union (select distinct playerID,yearID from Fielding) ) as var group by playerID ) as fvar where people.playerID=fvar.playerID order by num_seasons desc , playerID asc , firstname asc , lastname asc , date_of_birth asc ;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT People.playerID AS playerid, COALESCE(nameFirst, '') as firstname, COALESCE(nameLast, '') as lastname,TO_DATE((CASE WHEN People.birthYear IS NULL OR People.birthMonth IS NULL OR People.birthDay IS NULL THEN '' ELSE People.birthYear || '-' || People.birthMonth || '-' || People.birthDay END), 'YYYY MM DD') as date_of_birth, COALESCE(num_seasons, 0) as num_seasons FROM People LEFT JOIN ( SELECT playerID, COUNT(yearID) as num_seasons FROM ( SELECT playerID, yearID FROM Batting UNION SELECT playerID, yearID FROM Pitching UNION SELECT playerID, yearID FROM Fielding ) AS t GROUP BY playerID ) AS t2 ON People.playerID = t2.playerID ORDER BY COALESCE(num_seasons, 0) DESC, playerid, firstname, lastname, birthYear;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT playerid, firstname, lastname, date_of_birth, COUNT(*) AS num_seasons FROM (SELECT playerID, nameFirst, nameLast, COALESCE(birthYear || '-' || LPAD(birthMonth::text, 2, '0') || '-' || LPAD(birthDay::text, 2, '0'),''), yearID FROM People NATURAL JOIN ((Batting FULL OUTER JOIN Pitching USING (playerID, yearID, stint)) FULL OUTER JOIN Fielding USING (playerID, yearID, stint)) GROUP BY playerID, nameFirst, nameLast, birthYear, birthMonth, birthDay, yearID) AS P(playerid, firstname, lastname, date_of_birth, seasonid) GROUP BY playerid, firstname, lastname, date_of_birth ORDER BY num_seasons DESC, playerid ASC, firstname ASC, lastname ASC, date_of_birth ASC;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
select t.playerid,nameFirst as firstname, nameLast as lastname, cast(birthyear as char(4)) || '-' || case when birthmonth<10 then '0'||cast(birthmonth as char(2)) else cast(birthmonth as char(2)) end || '-' ||  case when birthday<10 then '0' || cast(birthday as char(2)) else cast(birthday as char(2)) end as date_of_birth, count(*) as num_seasons from(select playerid, yearid from batting union select playerid, yearid from pitching union select playerid, yearid from fielding) as t,people where t.playerid=people.playerid group by t.playerid,firstname,lastname,date_of_birth order by num_seasons desc,playerid,firstname,lastname,date_of_birth;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
with t as ( select batting.playerid, batting.yearid from batting, fielding, pitching where batting.playerid = pitching.playerid and pitching.playerid = fielding.playerid group by batting.playerid, batting.yearid ), q as ( select t.playerid, nameFirst as firstname, nameLast as lastname, coalesce(birthyear::varchar(255),' ')||'-'||coalesce(birthmonth::varchar(255),' ')||'-'||coalesce(birthday::varchar(255),' ') as date_of_birth, yearid from people, t where t.playerid = people.playerid ) select playerid, firstname, lastname, date_of_birth, count(yearid) as num_seasons from q group by playerid, firstname, lastname, date_of_birth order by num_seasons desc,playerid, firstname, lastname, date_of_birth ;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
with total8(playerid,num_seasons) as (select playerid,count(distinct yearid) from appearances where yearid is not null group by playerid) select distinct total8.playerid,coalesce(namefirst,'') as firstname,coalesce(namelast,'') as lastname,to_char(birthyear,'FM0999')||'-'||to_char(birthMonth,'FM09')||'-'||to_char(birthday,'FM09') as date_of_birth,num_seasons from total8,people where total8.playerid=people.playerid order by num_seasons desc,total8.playerid asc,firstname asc,lastname asc,date_of_birth asc;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
WITH T1 AS ( SELECT DISTINCT yearid, playerid FROM batting UNION SELECT DISTINCT yearid, playerid FROM pitching UNION SELECT DISTINCT yearid, playerid FROM fielding ), T2 AS ( SELECT playerid, COUNT(*) AS num_seasons FROM T1 GROUP BY playerid ) SELECT people.playerid, COALESCE(nameFirst,'') as firstname, COALESCE(nameLast,'') as lastname, LPAD(birthyear :: text, 4, '0') || '-' || LPAD(birthmonth :: text, 2, '0') || '-' || LPAD(birthday :: text, 2, '0') AS date_of_birth, COALESCE(num_seasons,0) as num_seasons FROM people JOIN T2 ON T2.playerid = people.playerid ORDER BY num_seasons DESC, playerid ASC, firstname ASC, lastname ASC, date_of_birth ASC;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
WITH player_Union AS ( SELECT playerID, yearID FROM batting UNION SELECT playerID, yearID FROM pitching UNION SELECT playerID, yearID FROM fielding ) SELECT player_Union.playerID, namefirst AS firstname , namelast AS lastname , DATE(birthYear||'-'||birthMonth||'-'||birthDay )AS date_of_birth , COUNT(yearID) AS num_season FROM people, player_Union WHERE people.playerID = player_Union.playerID GROUP BY player_Union.playerID, firstname , lastname , date_of_birth ORDER BY num_season DESC, player_Union.playerID, firstname , lastname , date_of_birth ;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
select people.playerid, namefirst as firstname, namelast as lastname, cast(cast(birthyear*10000+birthmonth*100+birthday as varchar(112)) as date) as date_of_birth, count(fielding.yearid) as num_seasons from people, batting, fielding, pitching where people.playerid= batting.playerid and people.playerid= fielding.playerid and people.playerid = pitching.playerid and batting.yearid = pitching.yearid and pitching.yearid = fielding.yearid group by people.playerid, firstname, lastname, birthyear, birthmonth, birthday order by num_seasons desc, firstname asc, lastname asc, date_of_birth asc;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
select p.playerid, p.nameFirst as firstname, p.namelast as lastname, (case when p.birthyear is null or p.birthmonth is null or p.birthday is null or p.birthyear = 0 or p.birthmonth = 0 or p.birthday = 0 then '' else TO_CHAR(p.birthyear,'9999') || '-' || TO_CHAR(p.birthmonth,'FM00') || '-' || TO_CHAR(p.birthday,'FM00') end ) as date_of_birth, count(a.yearid) as num_seasons from people p join ( select playerid, yearid from batting b UNION select playerid, yearid from fielding f UNION select playerid, yearid from pitching c) a on p.playerid = a.playerid group by p.playerid, firstname, lastname, date_of_birth order by num_seasons desc, p.playerid, firstname, lastname, date_of_birth;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
with players_table as ( select distinct playerID, yearID from Batting union select distinct playerID, yearID from Pitching union select distinct playerID, yearID from Fielding ), seasons_table as ( select playerID, count(distinct yearID) as num_seasons from players_table group by playerID ) select People.playerID as playerid, nameFirst as firstname, nameLast as lastname, case when birthDay is null or birthMonth is null or birthYear is null then '' else cast( birthYear as varchar(4))|| '-'|| (case when birthMonth<10 then '0'||cast(birthMonth as varchar(1)) else cast(birthMonth as varchar(2)) end)|| '-'|| (case when birthDay<10 then '0'||cast(birthDay as varchar(1)) else cast(birthDay as varchar(2)) end) end as date_of_birth, coalesce(num_seasons,0) as num_seasons from seasons_table join People on seasons_table.playerID = People.playerID order by num_seasons desc, playerid asc, firstname asc, lastname asc, date_of_birth asc;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT people.playerid, COALESCE(namefirst, '') AS firstname, COALESCE(namelast, '') AS lastname, COALESCE(CAST(birthyear AS VARCHAR) || '-' || to_char(birthmonth, 'FM09') || '-' || to_char(birthday, 'FM09'),'') AS date_of_birth, COALESCE(COUNT(DISTINCT yearid),0) as num_seasons FROM people JOIN appearances ON people.playerid = appearances.playerid GROUP BY 1, 2, 3, 4 ORDER BY 5 DESC, 1 ASC, 2 ASC, 3 ASC, 4 ASC;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT DISTINCT People.playerID, People.nameFirst AS firstname, People.nameLast AS lastname, People.birthYear||'-'|| People.birthMonth||'-'|| People.birthDay AS date_of_birth, COUNT(COALESCE(Seasons.yearID,0)) AS num_seasons FROM People JOIN (SELECT DISTINCT playerID, yearID FROM Batting UNION SELECT DISTINCT playerID, yearID FROM Pitching UNION SELECT DISTINCT playerID, yearID FROM Fielding) AS Seasons ON People.playerID = Seasons.playerID GROUP BY People.playerID, People.nameFirst, People.nameLast, People.birthYear, People.birthMonth, People.birthDay ORDER BY num_seasons DESC, People.playerID ASC, People.nameFirst ASC, People.nameLast ASC, People.birthYear ASC, People.birthMonth ASC, People.birthDay ASC;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
with num_seasons as ( SELECT playerid, count(distinct yearID) as num_seasons FROM (SELECT playerid, yearid from batting UNION SELECT playerid, yearid from pitching UNION SELECT playerid, yearid from Fielding) as all_players GROUP BY playerid ) SELECT num_seasons.playerid, p.nameFirst as firstname , p.nameLast as lastname , case when p.birthYear is null then '' when p.birthMonth is null then '' when p.birthDay is null then '' else case when p.birthDay < 10 and p.birthMonth < 10 then p.birthYear || '-0' || p.birthMonth || '-0' || p.birthDay when p.birthDay < 10 and p.birthMonth >= 10 then p.birthYear || '-' || p.birthMonth || '-0' || p.birthDay when p.birthDay >= 10 and p.birthMonth < 10 then p.birthYear || '-0' || p.birthMonth || '-' || p.birthDay else p.birthYear || '-' || p.birthMonth || '-' || p.birthDay end end as date_of_birth, num_seasons.num_seasons FROM (num_seasons JOIN (SELECT playerID, nameFirst, nameLast, birthYear, birthMonth, birthDay from People) as p on num_seasons.playerid = p.playerid) ORDER BY num_seasons DESC, playerid ASC, nameFirst ASC, nameLast ASC, birthYear ASC;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT playerid, nameFirst, nameLast, DATE(COALESCE(birthyear) || '-' || COALESCE(birthmonth) || '-' || COALESCE(birthday)) AS date_of_birth, count(DISTINCT yearid) as num_seasons FROM (SELECT people.playerid, people.nameFirst, people.nameLast, people.birthday, people.birthmonth, people.birthyear, batting.yearid FROM People JOIN Batting ON batting.Playerid = people.playerid UNION SELECT people.playerid, people.nameFirst, people.nameLast, people.birthday, people.birthmonth, people.birthyear, pitching.yearid FROM People JOIN Pitching ON pitching.playerid = people.playerid UNION SELECT people.playerid, people.nameFirst, people.nameLast, people.birthday, people.birthmonth, people.birthyear, fielding.yearid FROM People JOIN Fielding ON Fielding.playerid = people.playerid) AS Table_1 GROUP BY playerid, nameFirst, nameLast, birthday, birthmonth, birthyear ORDER BY num_seasons DESC, playerid, nameFirst, nameLast, date_of_birth;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT p.playerID, p.nameFirst AS firstname, p.nameLast AS lastname, COALESCE(p.birthYear || '-' || p.birthMonth || '-' || p.birthDay, '') AS date_of_birth, COUNT(DISTINCT yearID) AS num_seasons FROM (SELECT playerID, yearID FROM batting UNION SELECT playerID, yearID FROM pitching UNION SELECT playerID, yearID FROM fielding) AS all_roles JOIN People p ON all_roles.playerID = p.playerID GROUP BY p.playerID, p.nameFirst, p.nameLast, COALESCE(p.birthYear || '-' || p.birthMonth || '-' || p.birthDay, '') ORDER BY num_seasons DESC, p.playerID asc, p.nameFirst asc, p.nameLast asc, date_of_birth asc;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT people.playerID, nameFirst AS firstname, nameLast AS lastname,(CASE WHEN (birthYear IS NULL OR birthMonth IS NULL OR birthDay IS NULL) THEN '' ELSE CAST(birthYear AS VARCHAR(10))||'-'|| CAST(birthMonth AS VARCHAR(20))||'-'||CAST(birthDay AS VARCHAR(10)) END) as date_of_birth, count(*) AS num_seasons FROM people, (SELECT (CASE WHEN PID IS NOT NULL THEN PID ELSE field.playerID END) AS PPID, (CASE WHEN YID IS NOT NULL THEN YID ELSE field.yearID END) AS YYID FROM (SELECT (CASE WHEN bat.playerId IS NOT NULL THEN bat.playerID ELSE pitch.playerID END) AS PID, (CASE WHEN bat.yearID IS NOT NULL THEN bat.yearID ELSE pitch.yearID END) AS YID FROM (SELECT DISTINCT playerID, yearID FROM batting GROUP BY playerID,yearID) as bat FULL OUTER JOIN (SELECT DISTINCT playerID, yearID FROM pitching GROUP BY playerID,yearID) as pitch ON bat.playerID = pitch.playerID AND bat.yearID = pitch.yearID) AS batpitch FULL OUTER JOIN (SELECT DISTINCT playerID, yearID FROM fielding GROUP BY playerID,yearID) AS field ON PID= field.playerID AND YID=field.yearID) AS bpf WHERE people.playerID = PPID GROUP BY people.playerID,nameFirst,nameLast,birthYear,birthMonth,birthDay ORDER BY count(*) DESC,playerID ASC,firstname ASC, lastname ASC,date_of_birth ASC;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT COUNT(*) FROM (goals JOIN players ON goals.player_id = players.player_id) WHERE players.given_name = 'Cristiano' AND players.family_name='Ronaldo' AND goals.own_goal=FALSE;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
WITH Current AS (SELECT Batting.playerID AS playerID, Batting.yearID AS yearID FROM Batting UNION SELECT Pitching.playerID AS playerID, Pitching.yearID AS yearID FROM Pitching UNION SELECT Fielding.playerID AS playerID, Fielding.yearID AS yearID FROM Fielding ) SELECT Current.playerID AS playerid, People.nameFirst AS firstname, People.nameLast AS lastname,(People.birthYear || '-' || People.birthMonth || '-' || People.birthDay) AS date_of_birth ,COUNT(DISTINCT Current.yearID) AS num_seasons FROM Current INNER JOIN People ON Current.playerID = People.playerID GROUP BY Current.playerID, People.nameFirst,People.namelast, People.birthYear,People.birthMonth, People.birthDay ORDER BY num_seasons DESC,playerid ASC,firstname ASC,lastname ASC,date_of_birth ASC;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
select people.playerID , nameFirst as firstname , nameLast as lastname , case  when birthDay is null or birthMonth is null or birthYear is null then '' else birthYear || '-' ||  lpad(birthMonth::text,2,'0' ) || '-' || lpad(birthday::text , 2, '0') end as date_of_birth , num_seasons from people , (select playerid , count(*) as num_seasons from ((select playerID , yearID from batting) union (select playerID , yearID from Fielding) union (select playerid, yearid from pitching)) as t1 group by playerid) as t where t.playerID = people.playerID order by num_seasons desc , playerid asc , firstname asc , lastname asc , date_of_birth asc;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT player_seasons.playerid, firstname, lastname, date_of_birth, num_seasons FROM (SELECT playerid, COUNT(yearid) AS num_seasons FROM (SELECT playerid, yearid FROM batting UNION ALL SELECT playerid, yearid FROM pitching UNION ALL SELECT playerid, yearid FROM fielding) AS player_years GROUP BY playerid) AS player_seasons JOIN (SELECT playerid, nameFirst AS firstname, nameLast AS lastname, COALESCE(birthYear||'-'||birthMonth||'-'||birthDay, '') AS date_of_birth FROM people) AS players ON player_seasons.playerid = players.playerid ORDER BY num_seasons DESC, player_seasons.playerid ASC, firstname ASC, lastname ASC, date_of_birth ASC;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT playerid,nameFirst as firstname,nameLast as lastname,date_of_birth,COUNT(DISTINCT yearid) as num_seasons FROM (SELECT people.playerid,nameFirst,nameLast,(Coalesce(CAST(birthyear as varchar),'') || '-' || Coalesce(CAST(birthmonth as varchar),'') || '-' || Coalesce(CAST(birthDay as varchar),'')) as date_of_birth,yearid FROM people JOIN batting ON people.playerid=batting.playerid UNION SELECT people.playerid,nameFirst,nameLast,(Coalesce(CAST(birthyear as varchar),'') || '-' || Coalesce(CAST(birthmonth as varchar),'') || '-' || Coalesce(CAST(birthDay as varchar),'')) as date_of_birth,yearid FROM people JOIN fielding ON people.playerid=fielding.playerid UNION SELECT people.playerid,nameFirst,nameLast,(Coalesce(CAST(birthyear as varchar),'') || '-' || Coalesce(CAST(birthmonth as varchar),'') || '-' || Coalesce(CAST(birthDay as varchar),'')) as date_of_birth,yearid FROM people JOIN pitching ON people.playerid=pitching.playerid) as t2 group by playerid,nameFirst,nameLast,date_of_birth order by num_seasons desc, playerid asc,nameFirst asc, nameLast asc, date_of_birth asc ;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
with bp1f(playerID,yearID) as ( ( select playerID,yearID from Pitching ) union ( select playerID,yearID from Batting ) union ( select playerID,yearID from Fielding ) ), num(playerID,num_seasons) as ( select playerID,count(distinct yearID) from bp1f group by playerID ) select distinct p.playerID,p.nameFirst as firstname,p.nameLast as lastname,to_char(p.birthYear,'FM0999')||'-'||to_char(p.birthMonth,'FM09')||'-'||to_char(p.birthDay,'FM09') as date_of_birth,num.num_seasons from People p,num where p.playerID=num.playerID group by p.playerID,firstname,lastname,date_of_birth,num_seasons order by num_seasons desc,p.playerID asc,firstname asc,lastname asc,date_of_birth asc;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT temp.playerid, People.nameFirst AS firstname, People.nameLast as lastname, temp.num_seasons, CAST(CAST(People.birthYear*10000 + People.birthMonth*100 + People.birthDay as varchar(255)) as date) as date_of_birth FROM People, (SELECT tem.playerid as playerid, COUNT(yearid) AS num_seasons FROM (SELECT playerid, yearid FROM batting GROUP BY playerid, yearid) AS tem GROUP BY tem.playerid) AS temp WHERE People.playerID = temp.playerid ORDER BY num_seasons DESC, temp.playerid, firstname, lastname, date_of_birth DESC;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT a.playerid, a.nameFirst AS firstname, a.nameLast AS lastname, (CASE WHEN a.birthYear IS NOT NULL AND a.birthMonth IS NOT NULL AND a.birthDay IS NOT NULL THEN a.birthYear || '-' || a.birthMonth || '-' || a.birthDay ELSE '' END) AS date_of_birth, b.num_seasons FROM People a, ( WITH PlayerSeasons(playerID, yearid) AS (SELECT playerID, yearid FROM Batting UNION SELECT playerID, yearid FROM Pitching UNION SELECT playerID, yearid FROM Fielding) SELECT playerID, COUNT(yearid) AS num_seasons FROM PlayerSeasons GROUP BY playerID ) b WHERE a.playerid = b.playerid ORDER BY b.num_seasons DESC, a.playerid ASC, a.firstname ASC, a.lastname ASC. date_of_birth;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
WITH Dist_year AS( SELECT People.playerID AS playerID, COUNT(DISTINCT Batting.yearID) AS a, COUNT(DISTINCT Pitching.yearID) AS b, COUNT(DISTINCT Fielding.yearID) AS c FROM People JOIN Batting ON People.playerID = Batting.playerID JOIN Pitching ON People.playerID = Pitching.playerID JOIN Fielding ON People.playerID = Fielding.playerID WHERE Batting.yearID != Pitching.yearID AND Pitching.yearID != Fielding.yearID AND Fielding.yearID != Batting.yearID GROUP BY People.playerID) SELECT Dist_year.playerID AS playerid, People.nameFirst AS firstname, People.nameLast AS lastname, People.birthYear || '-' || People.birthMonth || '-' || People.birthDay AS date_of_birth, (Dist_year.a + Dist_year.b + Dist_year.c) AS nums_seasons FROM Dist_year JOIN People ON People.playerID = Dist_year.playerID ORDER BY nums_seasons DESC, playerid ASC, firstname ASC, lastname ASC, date_of_birth ASC;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT p.playerID as playerid, p.nameFirst as firstname, p.nameLast as lastname, COALESCE(lpad(birthYear::text, 4, '0')||'-'||lpad(birthmonth::text, 2, '0')||'-'||lpad(birthDay::text, 2, '0'),'') as date_of_birth, COUNT(DISTINCT yearID) as num_seasons FROM people p JOIN (SELECT playerID, yearID FROM batting UNION SELECT playerID, yearID FROM fielding UNION SELECT playerID, yearID FROM pitching) as t ON p.playerID = t.playerID GROUP BY p.playerid, firstname, lastname, date_of_birth ORDER BY num_seasons DESC, playerid ASC, firstname ASC, lastname ASC, date_of_birth ASC;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
select distinct p.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, case when birthyear is null or birthmonth is null or birthday is null then '' else lpad(p.birthyear :: text, 2, '0') || '-' || lpad(p.birthmonth :: text, 2, '0') || '-' || lpad(p.birthday :: text, 2, '0') end as date_of_birth, count(distinct t.yearid) as num_seasons from people as p join ( ( select playerid, yearid from batting ) union ( select playerid, yearid from pitching ) union ( select playerid, yearid from fielding ) ) as t on p.playerid = t.playerid group by p.playerid, firstname, lastname, date_of_birth order by num_seasons desc, p.playerid asc, firstname asc, lastname asc, date_of_birth asc;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT people.playerid,COALESCE(nameFirst,'') AS firstname, COALESCE(nameLast,'') AS lastname, (case when (birthyear IS NOT NULL AND birthmonth IS NOT NULL AND birthday IS NOT NULL) then birthyear||'-'||birthmonth||'-'||birthday else '' end) AS date_of_birth, COUNT(yearId) AS num_seasons FROM (SELECT DISTINCT playerid, yearId FROM batting UNION SELECT DISTINCT playerid, yearId FROM pitching UNION SELECT DISTINCT playerid, yearId FROM fielding) AS activity JOIN people ON activity.playerid=people.playerid GROUP BY people.playerid, firstname, lastname, date_of_birth ORDER BY num_seasons DESC, playerid, firstname, lastname, date_of_birth;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
Select People.playerID as playerid, nameFirst as firstname, nameLast as lastname, COALESCE(birthYear || '-' || birthMonth || '-' || birthDay, '') as date_of_birth, COUNT(*) as num_seasons FROM (SELECT DISTINCT playerID, yearID FROM Batting UNION SELECT DISTINCT playerID, yearID FROM Pitching UNION SELECT DISTINCT playerID, yearID FROM Fielding) as t JOIN People ON People.playerID = t.playerID GROUP BY People.playerID, nameFirst, nameLast, birthYear, birthMonth, birthDay ORDER BY num_seasons DESC, playerid, firstname, lastname, date_of_birth;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT DISTINCT People.playerID as playerid, nameFirst as firstname, nameLast as lastname, CASE People.birthYear IS NULL OR People.birthMonth IS NULL OR People.birthDay IS NULL WHEN True THEN '' ELSE (People.birthYear || '-' || lpad(People.birthMonth::text, 2, '0') || '-' || lpad(People.birthDay::text, 2, '0')) END AS date_of_birth, num_seasons FROM People JOIN ( SELECT playerID, COUNT(*) as num_seasons FROM (SELECT DISTINCT playerID, yearID FROM ((SELECT DISTINCT playerID, yearID FROM Batting) UNION (SELECT DISTINCT playerID, yearID FROM Fielding) UNION (SELECT DISTINCT playerID, yearID FROM Pitching)) as x) as v GROUP BY playerID ORDER BY num_seasons DESC) as w on People.playerID = w.playerID ORDER BY num_seasons DESC, playerid, firstname, lastname, date_of_birth;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT playerid, nameFirst as firstname, nameLast as lastname, date_of_birth,COUNT(yearID) as num_seasons FROM (SELECT People.playerid as playerID, nameFirst, nameLast, COALESCE(CAST(birthYear as varchar), '') || '-' || COALESCE(CAST(birthMonth as varchar), '') || '-' || COALESCE(CAST(birthDay as varchar), '') AS date_of_birth, yearID FROM People JOIN Batting ON People.playerID = Batting.playerID UNION SELECT People.playerid  as playerID, nameFirst, nameLast, COALESCE(CAST(birthYear as varchar), '') || '-' || COALESCE(CAST(birthMonth as varchar), '') || '-' || COALESCE(CAST(birthDay as varchar), '') AS date_of_birth, yearID FROM People JOIN Pitching ON People.playerID = Pitching.playerID UNION SELECT People.playerid as playerID, nameFirst, nameLast, COALESCE(CAST(birthYear as varchar), '') || '-' || COALESCE(CAST(birthMonth as varchar), '') || '-' || COALESCE(CAST(birthDay as varchar), '') AS date_of_birth, yearID FROM People JOIN Fielding ON People.playerID = Fielding.playerID) AS uniontable GROUP BY playerid, nameFirst, nameLast, date_of_birth ORDER BY COUNT(*) DESC, playerID ASC, nameFirst ASC, nameLast ASC, date_of_birth ASC;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
WITH m(playerid,seasonid) AS (SELECT playerID,yearID FROM batting UNION SELECT playerID,yearID FROM fielding),n(playerid,seasonid) AS (SELECT playerid,seasonid FROM m UNION SELECT playerID,yearID FROM pitching),o(playerid,num_seasons) AS (SELECT playerid,COUNT(seasonid) FROM n GROUP BY n.playerid ORDER BY COUNT(seasonid) DESC) SELECT o.playerid,COALESCE(people.nameFirst,'') AS firstname,COALESCE(people.nameLast,'') AS lastname,CASE WHEN (people.birthDay=NULL OR people.birthMonth=NULL OR people.birthYear=NULL) THEN '' ELSE CAST(people.birthYear AS varchar)||'-'||lpad(CAST(people.birthMonth AS varchar),2,'0')||'-'|| lpad(CAST(people.birthDay AS varchar),2,'0') END AS date_of_birth,o.num_seasons AS num_seasons FROM o,people WHERE o.playerid=people.playerID ORDER BY num_seasons DESC,playerid,firstname,lastname;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
WITH Pl(id, first, last, dob) as (SELECT playerid, namefirst, namelast, birthyear||'-'||birthmonth||'-'||birthday FROM people), b(id, yearid) as (SELECT playerid, yearid FROM batting), p(id, yearid) as (SELECT playerid, yearid FROM pitching), f(id, yearid) as (SELECT playerid, yearid FROM fielding), T(playerid, firstname, lastname, dob, yearid) as ( SELECT * FROM pl JOIN b on pl.id = b.id UNION SELECT * FROM pl JOIN p on pl.id = p.id UNION SELECT * FROM pl JOIN f on pl.id = f.id ) SELECT playerid, firstname, lastname, dob as date_of_birth, COUNT(*) as num_seasons FROM T GROUP BY playerid, firstname, lastname, dob ORDER BY num_seasons DESC, playerid, firstname, lastname, date_of_birth;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
select t.playerid as playerid, people.nameFirst as firstname, people.nameLast as lastname,(case when people.birthYear is null or people.birthMonth is null or people.birthDay is null then null else people.birthYear ||'-'||people.birthMonth||'-'||people.birthDay end )as date_of_birth, t.seasons as num_seasons from people, (select people.playerID as playerid,(select count(*) from (select yearID from batting where batting.playerID = people.playerID union select yearID from fielding where fielding.playerID = people.playerID ) as foo) as seasons from people group by playerID) as t where people.playerID = t.playerid order by num_seasons desc, playerid asc, firstname asc, lastname asc, date_of_birth asc;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
WITH t1 AS ( SELECT DISTINCT playerid, yearid FROM batting ), t2 AS ( SELECT DISTINCT playerid, yearid FROM pitching ), t3 AS ( SELECT DISTINCT playerid, yearid FROM fielding ), t4 AS ( SELECT COALESCE(u.playerid,t3.playerid) AS playerid, COALESCE(u.yearid,t3.yearid) AS yearid FROM ( SELECT COALESCE(t1.playerid,t2.playerid) AS playerid, COALESCE(t1.yearid,t2.yearid) AS yearid FROM t1 FULL OUTER JOIN t2 ON t1.playerid=t2.playerid AND t1.yearid=t2.yearid ) AS u FULL OUTER JOIN t3 ON t3.playerid=u.playerid AND t3.yearid=u.yearid ) SELECT people.playerid, namefirst AS firstname, namelast AS lastname, COALESCE(TO_DATE(birthyear||'-'||birthmonth||'-'||birthday,'YYYY-MM-DD'),NULL) AS date_of_birth, count AS num_seasons FROM people JOIN ( SELECT playerid, COUNT(yearid) FROM t4 GROUP BY playerid ) AS t5 ON people.playerid=t5.playerid ORDER BY num_seasons DESC, playerid ASC, firstname ASC, lastname ASC, date_of_birth ASC;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT t.playerID,nameFirst,nameLast,date_of_birth,COUNT(DISTINCT(YearID)) AS num_seasons FROM (SELECT People.playerID,nameFirst,nameLast,yearID,COALESCE(CAST(birthYear AS varchar) || '-' || CAST(birthMonth AS varchar) || '-' || CAST(birthDay AS varchar),'') AS date_of_birth FROM People JOIN Batting ON People.playerID = Batting.playerID UNION SELECT People.playerID,nameFirst,nameLast,yearID,COALESCE(CAST(birthYear AS varchar) || '-' || CAST(birthMonth AS varchar) || '-' || CAST(birthDay AS varchar),'') AS date_of_birth FROM People JOIN Pitching ON People.playerID = Pitching.playerID UNION SELECT People.playerID,nameFirst,nameLast,yearID,COALESCE(CAST(birthYear AS varchar) || '-' || CAST(birthMonth AS varchar) || '-' || CAST(birthDay AS varchar),'') AS date_of_birth FROM People JOIN Fielding ON People.playerID = Fielding.playerID) AS t GROUP BY playerID,nameFirst,nameLast,date_of_birth ORDER BY num_seasons DESC,playerID ASC,nameFirst ASC,nameLast ASC,date_of_birth ASC;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
WITH BAT AS( SELECT DISTINCT playerID, yearID FROM Batting ), PITCH AS( SELECT DISTINCT playerID, yearID FROM Pitching ), FIELD AS( SELECT DISTINCT playerID, yearID FROM Fielding ), Match AS( SELECT * FROM BAT UNION SELECT * FROM PITCH UNION SELECT * FROM FIELD ) SELECT People.playerID AS playerid, nameFirst AS firstname, nameLast AS lastname, CASE WHEN (birthYear IS NOT NULL AND birthMonth IS NOT NULL AND birthDay IS NOT NULL) THEN (CAST (People.birthYear AS varchar) || '-' || CASE WHEN (People.birthMonth<10) THEN ('0') ELSE '' END || CAST(People.birthMonth AS varchar) || '-' || CASE WHEN (People.birthDay<10) THEN ('0') ELSE '' END || CAST(People.birthDay AS varchar)) ELSE '' END AS date_of_birth, COUNT(yearID) AS num_seasons FROM Match, People WHERE Match.playerID = People.playerID GROUP BY People.playerID, firstname, lastname, date_of_birth ORDER BY num_seasons DESC, People.playerID ASC, firstname ASC, lastname ASC, date_of_birth ASC;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT t3.playerid, nameFirst as firstname, nameLast as lastname, COALESCE(birthYear || '-' || LPAD(birthMonth::text,2,'0') || '-' || LPAD(birthDay::text,2,'0'),'') AS date_of_birth, t3.num_seasons FROM People JOIN ( SELECT playerid, COUNT(DISTINCT yearID) AS num_seasons FROM ( SELECT playerid, yearID from Batting union SELECT playerid, yearID from Fielding union select playerid, yearID from Pitching ) as temp GROUP BY playerid ) as t3 on t3.playerID = People.playerID order by num_seasons desc, playerid, lastname, firstname, date_of_birth;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
with appear as ( select distinct playerid, yearid from batting union (select distinct playerid, yearid from pitching) union (select distinct playerid, yearid from fielding)) SELECT people.playerid, namefirst AS firstname, namelast AS lastname, (CASE WHEN birthYear is null THEN '' WHEN birthMonth is null THEN '' WHEN birthDay is null THEN '' ELSE birthYear || '-' || birthMonth || '-' || birthDay END) AS date_of_birth, count(distinct (a.yearid)) AS num_seasons FROM people, appear AS a WHERE (people.playerid = a.playerid) GROUP BY people.playerid, firstname, lastname, date_of_birth ORDER BY num_seasons DESC, people.playerid ASC, firstname ASC, lastname ASC, date_of_birth ASC;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
WITH seasons AS( SELECT Batting.playerid AS playerid, Batting.yearid AS yearid FROM Batting UNION SELECT Pitching.playerid, Pitching.yearid FROM Pitching UNION SELECT fielding.playerid, fielding.yearid FROM fielding ), count_season AS ( SELECT seasons.playerid AS playerid, COUNT(seasons.yearid) AS counts FROM seasons GROUP BY seasons.playerid ) SELECT People.playerID AS playerid, People.nameFirst AS firstname, People.nameLast AS lastname, COALESCE(People.birthYear || '-' || People.birthMonth || '-' || People.BirthDay , '') AS date_of_birth, count_season.counts AS num_seasons FROM People JOIN count_season ON People.playerid = count_season.playerid ORDER BY num_seasons DESC, playerid ASC, firstname ASC, lastname ASC, date_of_birth ASC;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT seasons.playerid, nameFirst as firstname, nameLast as lastname, CONCAT(birthYear, '-', birthMonth, '-', birthDay) as  date_of_birth, COUNT(yearid) AS num_seasons FROM ( SELECT yearid, playerid FROM Batting UNION SELECT yearid, playerid FROM Pitching UNION SELECT yearid, playerid FROM Fielding ) AS seasons,people WHERE seasons.playerid = people.playerid GROUP BY seasons.playerid,firstname,lastname,date_of_birth ORDER BY num_seasons DESC, seasons.playerid ASC,firstname ASC,lastname ASC,date_of_birth ASC;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT People.playerid, nameFirst as firstname, nameLast as lastname, CASE WHEN birthYear IS NULL OR birthMonth IS NULL OR birthDay IS NULL THEN '' ELSE birthYear||'-'||lpad(birthMonth::text,2,'0')||'-'||lpad(birthDay::text,2,'0') END as date_of_birth, COUNT(yearid) AS num_seasons FROM People JOIN ((SELECT DISTINCT yearid, playerid FROM Batting GROUP BY playerid, yearid) UNION (SELECT DISTINCT yearid, playerid FROM Pitching GROUP BY playerid, yearid) UNION (SELECT DISTINCT yearid, playerid FROM Fielding GROUP BY playerid, yearid)) AS t ON t.playerid = People.playerid GROUP BY People.playerid, firstname, lastname, date_of_birth ORDER BY num_seasons DESC, playerid, firstname, lastname, date_of_birth;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
select t2.playerID, nameFirst as firstname, nameLast as lastname, coalesce(birthYear::varchar(4)||'-'||birthMonth::varchar(2)||'-'||birthDay::varchar(2), '') as date_of_birth, seasons as num_seasons from ( select distinct playerID, count(yearID) as seasons from ( select distinct playerID, yearID from ( select playerID, yearID from fielding group by playerID, yearID union all select playerID, yearID from batting group by playerID, yearID union all select playerID, yearID from pitching group by playerID, yearID ) as t10 ) as t group by playerID ) as t2 join People on t2.playerID = People.playerID order by seasons desc, playerID, firstname, lastname, date_of_birth;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT people.playerid as playerid, COALESCE(people.namefirst,'') as firstname, COALESCE(people.namelast,'') as lastname, COALESCE(birthyear || '-' || birthmonth || '-' || birthday,'') as date_of_birth, COUNT(DISTINCT year) as num_seasons FROM people, (SELECT playerid, yearid from batting UNION SELECT playerid, yearid from pitching UNION SELECT playerid, yearid from fielding GROUP BY playerid, yearid) as combyear(playerid, year) where combyear.playerid = people.playerid GROUP BY people.playerid, people.namefirst, people.namelast, birthyear,birthmonth,birthday ORDER BY num_seasons DESC, playerid ASC, firstname ASC, lastname ASC, date_of_birth ASC;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
with boo(playerid, yearid) as ( (select playerid, yearid from Batting) union (select playerid, yearid from Pitching) union (select playerid, yearid from Fielding) ), poo(playerid, firstname, lastname, dob) as ( select playerID, nameFirst as firstname, nameLast as lastname, coalesce(to_char(People.birthYear, '9999') || '-' || to_char(People.birthMonth, 'FM00') || '-' || to_char(People.birthDay, 'FM00'), '') as dob from People ) select boo.playerid as playerid, poo.firstname, poo.lastname, poo.dob as date_of_birth, count(yearid) as num_seasons from boo, poo where boo.playerid = poo.playerid group by boo.playerid, poo.firstname, poo.lastname, poo.dob order by num_seasons desc nulls last, playerid, firstname, lastname, date_of_birth;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
select t1.playerid, people.namefirst, people.namelast,(people.birthyear||'-'||people.birthmonth||'-'||people.birthday)as dob,t1.season_played from (select playerid,count(playerid)as season_played from (select playerid,yearid from batting union select playerid,yearid from pitching union select playerid,yearid from fielding)as t group by playerid)as t1 , people where people.playerid=t1.playerid order by t1.season_played desc , t1.playerid asc , people.namefirst asc , people.namelast asc , dob asc;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
with table0 as( select playerid, yearID from Batting union select playerid, yearID from Pitching union select playerid, yearID from Fielding ) select   table0.playerid, people.nameFirst as firstname, people.nameLast as lastname, COALESCE(lpad(birthYear::text, 4, '0')||'-'||lpad(birthmonth::text, 2, '0')||'-'||lpad(birthDay::text, 2, '0'),'') as date_of_birth, count(distinct yearid ) as numseasons from table0 inner join people on people.playerid = table0.playerid group by  table0.playerid, people.nameFirst , people.nameLast,date_of_birth order by     numseasons desc,table0.playerid , people.nameFirst , people.nameLast , date_of_birth ;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT DISTINCT T.playerID as playerid, nameFirst as firstname, nameLast as lastname, CASE WHEN (birthDay IS NULL) OR (birthYear IS NULL) OR (birthMonth IS NULL) THEN  '' ELSE to_char((to_date(to_char(birthYear,'9999')||to_char(birthMonth,'9999')||to_char(birthDay,'9999'), 'YYYY MM DD')), 'YYYY-MM-DD') END as  date_of_birth, (SELECT COUNT(*) FROM ( (SELECT yearID FROM Batting WHERE Batting.playerid = T.playerID)  UNION (SELECT yearID FROM Fielding WHERE Fielding.playerid = T.playerID) UNION (SELECT yearID FROM Pitching WHERE Pitching.playerid = T.playerID) ) AS T1 ) as num_seasons FROM People as T WHERE (SELECT COUNT(*) FROM ( (SELECT yearID FROM Batting WHERE Batting.playerid = T.playerID)  UNION (SELECT yearID FROM Fielding WHERE Fielding.playerid = T.playerID) UNION (SELECT yearID FROM Pitching WHERE Pitching.playerid = T.playerID) ) AS T1 )>0 ORDER BY num_seasons desc , playerid asc , firstname asc , lastname asc , date_of_birth asc;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
with z as (select playerid,yearid from batting  union select playerid,yearid from batting  union select playerid,yearid from pitching ) select people.playerid,people.nameFirst as firstname,people.nameLast as lastname,case when birthyear is not null and birthmonth is not null and birthday is not null then "birthyear"||'-'||LPAD(cast(birthmonth as varchar),2,'0') ||'-'||LPAD(cast(birthday as varchar),2,'0') else null end  as date_of_birth ,y.num_seasons from (select playerid,count(distinct yearid) as num_seasons from z group by playerid) as y inner join people on people.playerid=y.playerid order by num_seasons desc,playerid asc,firstname asc,lastname asc,date_of_birth asc ;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
select people.playerid, people.nameFirst as firstname, people.nameLast as lastname, coalesce(people.birthYear || '-' || people.birthMonth || '-' || people.birthDay,'') as date_of_birth, count(a.yearid) as num_seasons from people join ( select distinct yearid, playerid from batting union select distinct yearid, playerid from pitching union select distinct yearid, playerid from fielding) as a on a.playerid = people.playerid group by people.playerid, firstname, lastname, date_of_birth order by num_seasons desc, people.playerid, firstname, lastname, date_of_birth;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
select p.playerid, p.namefirst as firstname, p.namelast as lastname, CASE WHEN (p.birthYear is NULL or p.birthMonth is NULL or p.birthDay is NULL) THEN NULL ELSE ( COALESCE(p.birthYear) || '-' || COALESCE(p.birthMonth) || '-' || COALESCE(p.birthDay) ) END as date_of_birth, t.num_seasons from people p join ( select playerid, count(yearID) as num_seasons from ( select b.playerID, b.yearID from batting b UNION select p.playerID, p.yearID from pitching p UNION select f.playerID, f.yearID from fielding f ) as t group by playerid ) as t on p.playerID = t.playerID order by num_seasons DESC, playerid, firstname, lastname, date_of_birth;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT playerid, firstname, lastname, date_of_birth, count(distinct years) AS num_seasons FROM( SELECT People.playerID AS playerid, People.nameFirst as firstname, People.namelast as lastname, COALESCE(('"' || Cast(birthYear AS varchar) || '-' || Cast(birthMonth AS varchar) || '-' || Cast(birthDay AS varchar)|| '"'), '') AS date_of_birth, Batting.yearID AS years FROM Batting JOIN People on Batting.playerID = People.playerID UNION SELECT People.playerID AS playerid, People.nameFirst as firstname, People.namelast as lastname, COALESCE(('"' || Cast(birthYear AS varchar) || '-' || Cast(birthMonth AS varchar) || '-' || Cast(birthDay AS varchar)|| '"'), '') AS date_of_birth, Pitching.yearID AS years FROM Pitching JOIN People on Pitching.playerID = People.playerID UNION SELECT People.playerID AS playerid, People.nameFirst as firstname, People.namelast as lastname, COALESCE(('"' || Cast(birthYear AS varchar) || '-' || Cast(birthMonth AS varchar) || '-' || Cast(birthDay AS varchar)|| '"'), '') AS date_of_birth, Fielding.yearID AS years FROM Fielding JOIN People on Fielding.playerID = People.playerID ) AS t1 GROUP BY playerid, firstname, lastname, date_of_birth ORDER BY num_seasons DESC, playerid ASC, firstname ASC, lastname ASC, date_of_birth ASC;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
WITH t1 as( SELECT DISTINCT People.playerID as p_id, nameFirst as f_name, nameLast as l_name, BirthYear || '-' || BirthMonth || '-' || BirthDay as d_1b, yearID as s_id FROM People JOIN Batting ON Batting.playerID = People.playerID UNION ALL SELECT DISTINCT People.playerID as p_id,nameFirst as f_name, nameLast as l_name ,  BirthYear || '-' || BirthMonth || '-' || BirthDay as d_1b,  yearID as s_id FROM People JOIN Pitching ON Pitching.playerID = People.playerID UNION ALL SELECT DISTINCT People.playerID as p_id, nameFirst as f_name, nameLast as l_name,  BirthYear || '-' || BirthMonth || '-' || BirthDay as d_1b, yearID as s_id FROM People JOIN Fielding ON Fielding.playerID = People.playerID ), t2 as( SELECT DISTINCT p_id as t2_id,  f_name as p2_f , l_name as p2_l,d_1b as t2_dob , s_id as p2_sid FROM t1 ) SELECT t2_id as playerid, p2_f as firstname, p2_l as lastname, t2_dob as date_of_birth, COUNT(p2_sid) as num_seasons FROM t2 WHERE p2_sid is NOT NULL GROUP BY t2_id, p2_f, p2_l, t2_dob ORDER BY num_seasons DESC, playerid, firstname, lastname, date_of_birth;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
WITH tb AS( SELECT yearid AS season,playerid AS id FROM batting UNION ALL SELECT yearid AS season, playerid AS id FROM pitching UNION ALL SELECT yearid AS season, playerid AS id FROM fielding) SELECT DISTINCT id AS playerid, namefirst AS firstname, namelast AS lastname, COALESCE((COALESCE(birthyear)||'-'||COALESCE(birthmonth)||'-'||COALESCE(birthday)),'') AS date_of_birth, COUNT(DISTINCT season) AS num_seasons FROM people JOIN tb ON people.playerid=tb.id GROUP BY playerid,firstname,lastname,id,birthyear,birthmonth,birthday ORDER BY num_seasons DESC, playerid ASC, firstname ASC, lastname ASC, date_of_birth ASC;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT people.playerid, COALESCE(namefirst, '') AS firstname, COALESCE(namelast, '') AS lastname, CASE WHEN (birthyear IS NULL) OR (birthmonth IS NULL) OR (birthday IS NULL) THEN '' ELSE birthyear || '-' || birthmonth || '-' || birthyear END AS date_of_birth, num_seasons FROM people, ( SELECT playerid, COUNT(yearid) AS num_seasons FROM ( SELECT DISTINCT playerid, yearid FROM ( ( SELECT DISTINCT playerid, yearid FROM batting ) UNION ( SELECT DISTINCT playerid, yearid FROM pitching ) UNION ( SELECT DISTINCT playerid, yearid FROM fielding ) ) AS t1 )AS t2 GROUP BY playerid ) AS t3 WHERE people.playerid = t3.playerid ORDER BY num_seasons DESC, playerid, firstname, lastname, date_of_birth;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
WITH appear1 (playerID , num1) AS ( SELECT playerID , COUNT(DISTINCT yearID) AS season1 FROM Appearances GROUP BY playerID ) SELECT People.playerID AS playerid , People.nameFirst AS firstname , People.nameLast AS lastname , CASE WHEN People.birthYear IS NOT NULL AND People.birthMonth IS NOT NULL AND People.birthDay IS NOT NULL THEN People.birthYear || '-' ||  lpad(birthMonth::text, 2, '0') || '-' || lpad(birthDay::text , 2, '0') ELSE '' END AS date_of_birth , appear1.num1 AS num_seasons FROM appear1 , People WHERE appear1.playerID = People.playerID ORDER BY appear1.num1 DESC , People.playerID ASC , People.nameFirst ASC , People.nameLast ASC, People.birthYear ASC ,People.birthMonth ASC ,People.birthDay ASC;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
with detail(p_id ,ct) as ( select distinct playerID , count(yearID) from (select distinct b.playerID , b.yearID  from batting b UNION ( select distinct p.playerID , p.yearID  from pitching p) UNION (select distinct f.playerID, f.yearID from fielding f) ) as data  group by playerID )  select p_id as playerid ,nameFirst as firstname, nameLast as lastname,(CASE When p.birthday is NULL OR p.birthmonth is NULL OR p.birthyear is NULL then '' Else p.birthyear||'-'|| lpad(birthmonth::text, 2, '0')||'-'||lpad(birthday::text, 2, '0') END) as date_of_birth ,ct as num_seasons from detail d left join people p on d.p_id = p.playerID and p.birthDay is not NULL and p.birthMonth is not NULL and p.birthYear is not NULL  order by ct desc , p_id , firstname , lastname , date_of_birth;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
select L.playerid,P.namefirst as firstname,P.nameLast as lastname,P.birthYear as date_of_birth,L.num_seasons from (select Y.playerid, count(Y.lgID) as num_seasons from (select A.playerid,A.yearID,A.lgID from batting A UNION select F.playerid,F.yearID,F.lgID from fielding F UNION select PI.playerid,PI.yearID,PI.lgID from pitching PI) Y group by Y.playerid) L left outer join people P on P.playerid = L.playerid order by L.num_seasons desc, L.playerid asc, firstname asc, lastname asc, date_of_birth asc;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
with cte AS ( SELECT playerid, COUNT(DISTINCT(yearid)) as num_seasons FROM appearances WHERE g_all IS NOT NULL AND g_all!= 0 GROUP BY playerid ) SELECT cte.playerid, nameFirst, nameLast, CASE WHEN birthYear IS NOT NULL AND birthMonth IS NOT NULL AND birthDay IS NOT NULL THEN birthYear || '-' || birthMonth || '-' || birthDay ELSE '' END AS date_of_birth,num_seasons FROM cte, people WHERE people.playerid = cte.playerid ORDER BY num_seasons DESC, playerid, nameFirst, nameLast, date_of_birth;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT People.playerid , COALESCE(nameFirst,'') as firstname , COALESCE(nameLast,'') as lastname , CASE WHEN birthYear IS NULL OR birthMonth IS NULL OR birthDay IS NULL THEN NULL ELSE TO_DATE(birthYear||'-'||birthMonth||'-'||birthDay,'YYYY MM DD') END date_of_birth , COUNT(DISTINCT yearid_) as num_seasons FROM People , (SELECT yearid,playerid FROM Batting UNION SELECT yearid,playerid FROM Pitching UNION SELECT yearid,playerid FROM Fielding) as FP(yearid_,playerid_) WHERE People.playerid=FP.playerid_ GROUP BY playerid, firstname , lastname , date_of_birth ORDER BY num_seasons DESC , playerid ASC , firstname ASC , lastname ASC , date_of_birth ASC;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
select people.playerid as playerid , namefirst as firstname,namelast as lastname, CASE WHEN ((birthyear is null) or(birthmonth is null) or(birthday is null)) then '' ELSE  (coalesce(cast(birthyear as text),'')||'-'||coalesce(lpad(cast(birthmonth as text),2,'0'),'')||'-'||coalesce(cast(birthday as text),'')) END AS date_of_birth , t2.seasons as num_seasons FROM  (select playerid ,count(*) FROM ( (SELECT playerID,yearID FROM batting WHERE coalesce(stint,0)>0) UNION (SELECT playerID,yearID FROM Pitching where coalesce(stint,0)>0) UNION (Select playerId,yearId FROM fielding where coalesce(stint,0)>0)) as t group by playerid) as t2(playerid,seasons), people WHERE people.playerid=t2.playerid ORDER BY num_seasons DESC, playerid ASC, firstname ASC, lastname ASC;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT p.playerID,p.nameFirst as firstname,p.nameLast as lastname,(CASE WHEN birthyear is null or birthmonth is null or birthday is null then ' ' ELSE birthYear || '-' || birthMonth || '-' || birthDay END) as date_of_birth,COUNT(DISTINCT(yearID)) as num_seasons FROM People p,Appearances a WHERE p.playerID=a.playerID GROUP BY p.playerID ORDER BY num_seasons DESC;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT v.playerid, nameFirst AS firstname, nameLast AS lastname, date_of_birth, num_seasons FROM (SELECT playerid, COUNT(yearid) AS num_seasons FROM ((SELECT playerid, yearid FROM batting) UNION (SELECT playerid, yearid FROM pitching) UNION (SELECT playerid, yearid FROM fielding)) AS t GROUP BY playerid ORDER BY COUNT(yearid) DESC) AS v, (SELECT *, case  when birthDay is null or birthMonth is null or birthYear is null then '' else birthYear||'-'||lpad(birthMonth::text,2,'0' )||'-'||lpad(birthday::text,2, '0') end AS date_of_birth FROM people) AS g WHERE v.playerid = g.playerid ORDER BY num_seasons DESC, v.playerid ASC, namefirst ASC, namelast ASC, date_of_birth ASC;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT People.playerID AS playerid, (CASE WHEN nameFirst IS NULL THEN '' ELSE nameFirst END) AS firstname, (CASE WHEN nameLast IS NULL THEN '' ELSE nameLast END) AS lastname, TO_DATE((CASE WHEN People.birthYear IS NULL OR People.birthMonth IS NULL OR People.birthDay IS NULL THEN '' ELSE People.birthYear || '-' || People.birthMonth || '-' || People.birthDay END), 'YYYY MM DD') as date_of_birth, COUNT(*) as num_seasons FROM People JOIN (SELECT DISTINCT COALESCE(batting_yearly.playerID, fielding_yearly.playerID, pitching_yearly.playerID) AS playerid, COALESCE(batting_yearly.yearID, fielding_yearly.yearID, pitching_yearly.yearID) AS yearid FROM (SELECT playerID, yearID FROM Batting GROUP BY playerID, yearID ) AS batting_yearly FULL JOIN (SELECT playerID, yearID FROM Fielding GROUP BY playerID, yearID ) AS fielding_yearly ON batting_yearly.playerID = fielding_yearly.playerID FULL JOIN (SELECT playerID, yearID FROM Pitching GROUP BY playerID, yearID ) AS pitching_yearly ON COALESCE(batting_yearly.playerID, fielding_yearly.playerID) = pitching_yearly.playerID ) AS all_table ON People.playerID = all_table.playerid GROUP BY People.playerID, firstname, lastname, date_of_birth ORDER BY num_seasons DESC, playerid ASC, firstname ASC, lastname ASC, date_of_birth ASC;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
With batt_pitching(player,year) AS (SELECT playerID,yearID FROM batting UNION SELECT playerID,yearID FROM pitching), tot(player,year) AS (SELECT player,year FROM batt_pitching UNION SELECT playerID,yearID FROM fielding) SELECT player AS playerid, nameFirst AS firstname,nameLast AS lastname,birthYear ||'-'||lpad(birthMonth::text,2,'0')||'-'||lpad(birthDay::text,2,'0')  AS date_of_birth,COUNT(year) AS num_seasons FROM batt_pitching,people WHERE player=playerID GROUP BY player,nameFirst,nameLast,birthYear,birthDay,birthMonth ORDER BY num_seasons DESC,playerid,firstname,lastname,date_of_birth;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT People.playerID as playerid, People.nameFirst as firstname, People.nameLast as lastname, ( CASE WHEN People.birthMonth IS NULL or People.birthDay IS NULL or People.birthYear IS NULL THEN '' ELSE CAST(People.birthYear as varchar) || '-' || TO_CHAR(People.birthMonth, 'fm00') || '-' || TO_CHAR(People.birthDay, 'fm00') END ) as date_of_birth, COUNT(t.yearID) as no_of_seasons FROM People LEFT OUTER JOIN( SELECT playerID, yearID FROM Batting UNION SELECT playerID, yearID FROM Pitching UNION SELECT playerID, yearID FROM Fielding ) as t on People.playerID = t.playerID GROUP BY People.playerID, firstname, lastname, date_of_birth ORDER BY no_of_seasons DESC, People.playerID ASC, firstname ASC, lastname ASC, date_of_birth ASC;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT People.playerid, People.nameFirst as firstname, People.nameLast as lastname, to_date(to_char(birthyear, '9999') || to_char(birthmonth, '9999') || to_char(birthday, '9999'), 'YYYY MM DD') as date_of_birth, COUNT(DISTINCT T.yearid) as num_seasons FROM People JOIN (SELECT People.playerid, Batting.yearid FROM People JOIN Batting ON People.playerid = Batting.playerid UNION SELECT People.playerid, Pitching.yearid FROM People JOIN Pitching ON People.playerid = Pitching.playerid UNION SELECT People.playerid, Fielding.yearid FROM People JOIN Fielding ON People.playerid = Fielding.playerid ) as T ON People.playerid = T.playerid GROUP BY People.playerid, firstname, lastname, date_of_birth ORDER BY num_seasons DESC, playerid ASC, firstname ASC, lastname ASC, date_of_birth ASC;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
WITH data1(p_id,y_id) AS (SELECT batting.playerID,batting.yearID FROM batting UNION SELECT pitching.playerId,pitching.yearID FROM pitching ORDER BY playerID,yearID),data2(p_id,y_id) AS (SELECT data1.p_id,data1.y_id FROM data1 UNION SELECT fielding.playerID,fielding.yearID FROM fielding) SELECT people.playerID AS playerid,people.nameFirst AS firstname,people.nameLast AS lastname,CASE WHEN people.birthYear IS NOT NULL AND people.birthMonth IS NOT NULL AND people.birthDay IS NOT NULL THEN people.birthYear||'-'||lpad(people.birthMonth::text,2,'0')||'-'||lpad(people.birthDay::text,2,'0') ELSE '' END AS date_of_birth,COUNT(*) AS num_seasons FROM data2,people WHERE people.playerID=data2.p_id GROUP BY playerid,firstname,lastname,date_of_birth ORDER BY num_seasons DESC,playerid ,firstname,lastname,date_of_birth;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
WITH seasons AS ( SELECT playerid, yearid FROM Batting WHERE (AB = NULL) OR (AB = 0) OR (H = NULL) UNION SELECT playerid, yearid FROM Pitching UNION SELECT playerid, yearid FROM Fielding ) SELECT seasons.playerid, nameFirst AS firstname, nameLast AS lastname, COALESCE(CAST(birthyear AS VARCHAR(4)) || '-' || LPAD(CAST(birthmonth AS VARCHAR(2)), 2, '0') || '-' || LPAD(CAST(birthday AS VARCHAR(2)), 2, '0'), '') AS date_of_birth, COUNT(yearid) AS num_seasons FROM People, seasons WHERE People.playerid = seasons.playerid GROUP BY seasons.playerid, firstname, lastname, date_of_birth ORDER BY num_seasons DESC, playerid, firstname, lastname, date_of_birth;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
Select people.playerid, Coalesce(people.namefirst,'') as firstname, Coalesce(people.namelast,'') as lastname, Coalesce(birthyear || '-' || birthmonth || '-' || birthday,'') as date_of_birth, COUNT(Distinct yearid) as num_seasons From people Join appearances On people.playerid = appearances.playerid Group by people.playerid, firstname, lastname, birthyear, birthmonth, birthday Order by num_seasons DESC, playerid, firstname, lastname, date_of_birth;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
WITH HT AS( SELECT playerID , yearID FROM ( SELECT playerID , yearID FROM BATTING UNION SELECT playerID , yearID FROM Pitching UNION SELECT playerID , yearID FROM Fielding ) AS HT2 GROUP BY HT2.playerID , HT2.yearID ) SELECT people.playerID AS playerid, people.namefirst AS firstname, people.namelast AS lastname, to_date((People.BirthYear || '-' || People.BirthMonth || '-' || People.BirthDay) , 'YYYY-MM-DD') as date_of_birth, count(HT.yearID) as num_seasons FROM HT JOIN People ON People.playerID = HT.playerID GROUP BY People.playerID, People.nameFirst, People.nameLast, People.birthDay, People.birthYear, People.birthMonth ORDER BY num_seasons DESC, playerid ASC, firstname ASC, lastname ASC, date_of_birth ASC;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT people.playerID,Coalesce(people.namefirst,'') as firstname,Coalesce(people.namelast,'') as lastname, to_char(people.birthYear,'FM0999') || '-' || to_char(people.birthMonth,'FM09') || '-' || to_char(people.birthDay,'FM09') as date_of_birth ,count(Distinct(Appearances.yearID)) as num_seasons FROM people join Appearances on (people.playerID=Appearances.playerID) where Appearances.yearID IS NOT NULL GROUP BY people.playerID,people.namefirst,people.namelast,people.birthYear,people.birthMonth,people.birthDay ORDER BY count(Distinct(Appearances.yearID)) DESC,people.playerID,Coalesce(people.namefirst,''),Coalesce(people.namelast,''),to_char(people.birthYear,'FM0999') || '-' || to_char(people.birthMonth,'FM09') || '-' || to_char(people.birthDay,'FM09');
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT t1.playerid, nameFirst firstname, nameLast lastname, (CASE When p.birthday is NULL OR p.birthmonth is NULL OR p.birthyear is NULL then '' Else p.birthyear||'-'|| lpad(birthmonth::text, 2, '0')||'-'||lpad(birthday::text, 2, '0') END) as date_of_birth , COUNT(*) num_seasons FROM ( SELECT DISTINCT * FROM ( SELECT DISTINCT playerid, yearid FROM batting UNION SELECT DISTINCT playerid, yearid FROM pitching UNION SELECT DISTINCT playerid, yearid FROM fielding) as t) as t1 LEFT JOIN people p ON p.playerid = t1.playerid GROUP BY t1.playerid, firstname, lastname, date_of_birth ORDER BY num_seasons DESC, t1.playerid, firstname, lastname, date_of_birth;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT t.playerid,COALESCE(People.namefirst,'') AS firstname, COALESCE(People.namelast,'') AS lastname, (COALESCE(People.birthYear || '-' || People.birthMonth || '-' || People.birthDay,'')) AS date_of_birth, COUNT(DISTINCT(t.yearID)) AS num_seasons FROM People JOIN (SELECT People.playerID AS playerid,yearID FROM People JOIN Batting ON People.playerID=Batting.playerID GROUP BY People.playerID,Batting.yearID UNION SELECT People.playerID AS playerid,yearID FROM People JOIN Fielding ON People.playerID=Fielding.playerID GROUP BY People.playerID,Fielding.yearID UNION SELECT People.playerID AS playerid,yearID FROM People JOIN Pitching ON People.playerID=Pitching.playerID GROUP BY People.playerID,Pitching.yearID) AS t ON People.playerID = t.playerid GROUP BY t.playerid,firstname,lastname,date_of_birth ORDER BY num_seasons DESC, playerid ASC, firstname ASC, lastname ASC, date_of_birth ASC;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT t.playerID, COALESCE(nameFirst, '') AS firstname, COALESCE(nameLast, '') AS lastname, CASE WHEN birthYear IS NULL OR birthMonth IS NULL OR birthDay IS NULL THEN '' ELSE birthYear || '-' || birthMonth || '-' || birthDay END AS date_of_birth, COUNT(DISTINCT yearID) AS num_seasons FROM People, ( SELECT playerID, yearID FROM Batting UNION SELECT playerID, yearID FROM Fielding UNION SELECT playerID, yearID FROM Pitching ) AS t WHERE t.playerID = People.playerId GROUP BY t.playerID, firstname, lastname, date_of_birth ORDER BY num_seasons DESC, t.playerID, firstname, lastname, date_of_birth;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
WITH temp(playerid,num_seasons) as (SELECT t.playerid,COUNT(distinct yearid) as num_seasons FROM (SELECT playerid,yearid from pitching UNION SELECT playerid,yearid from batting UNION SELECT playerid,yearid from fielding) as t GROUP BY t.playerid) SELECT temp.playerid,nameFIRST as firstname,nameLAST as lastname,coalesce((CAST(birthYear AS varchar) || '-' || CAST(birthMonth AS varchar) || '-' || CAST(birthDay AS varchar)),'') as date_of_birth,num_seasons order by num_seasons desc,playerid,firstname,lastname,date_of_birth;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
SELECT playerid, namefirst,namelast,case when birthyear is null or birthday is null or birthmonth is null then '' else birthyear||'-'||birthmonth||'-'||birthday end as date_of_birth, num_seasons FROM people join (SELECT playerid, count(*) as num_seasons FROM (SELECT DISTINCT playerid,yearid FROM batting UNION SELECT DISTINCT playerid,yearid FROM pitching UNION SELECT DISTINCT playerid,yearid FROM fielding)as t1 GROUP BY playerid)as t2 using (playerid) ORDER BY num_seasons DESC,playerid,namefirst,namelast,date_of_birth;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
select people.playerid as playerid, namefirst as firstname, namelast as lastname, coalesce(birthYear || '-' || birthMonth || '-' || birthDay,'') as date_of_birth, num_seasons from people inner join ( select playerid, count(distinct yearid) as num_seasons from ( select distinct playerid, yearid from batting union Select distinct playerid, yearid from fielding union Select distinct playerid, yearid from pitching ) as t group by playerid ) as t1 on (t1.playerid = people.playerid) order by num_seasons desc, playerid asc, firstname asc, lastname asc, date_of_birth asc ;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
select DISTINCT t2.playerid, COALESCE(people.nameFirst, '') as firstname, COALESCE(people.nameLast, '') as lastname, to_date((case when people.birthYear IS NULL OR people.birthMonth IS NULL OR people.birthDay IS NULL then '' else (people.birthYear || ' ' || people.birthMonth || ' ' || people.birthDay)  end), 'YYYY MM DD') as date_of_birth, t2.num_seasons from (select t1.pid as playerid, count(t1.*) as num_seasons from (select COALESCE(COALESCE(batting.playerid, pitching.playerid), fielding.playerid) as pid, COALESCE(COALESCE(batting.yearid, pitching.yearid), fielding.yearid) as yid from batting full join pitching on batting.playerid = pitching.playerid and batting.yearid = pitching.yearid full join fielding on COALESCE(batting.playerid, pitching.playerid) = fielding.playerid and COALESCE(batting.yearid, pitching.yearid) = fielding.yearid group by pid, yid) as t1 group by t1.pid order by num_seasons) t2 join people on t2.playerid = people.playerid order by t2.num_seasons desc, t2.playerid, firstname, lastname, date_of_birth;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
with t0 as ( select playerid, yearid from Batting union select playerid, yearid from Pitching union select playerid, yearid from Fielding group by playerid, yearid ), t1 as ( select playerid, count(distinct(yearid)) as num_seasons from t0 group by playerid ) select People.playerid, namefirst as firstname, namelast as lastname, lpad(cast(birthyear as text), 4, '0') || '-' || lpad(cast(birthmonth as text), 2, '0') || '-' || lpad(cast(birthday as text), 2, '0') as date_of_birth, coalesce(num_seasons, 0) as num_seasons from People, t1 where People.playerid = t1.playerid order by num_seasons desc, playerid, firstname, lastname, date_of_birth;
with all_tables as (select playerid, yearid from batting group by playerid, yearid union select playerid, yearid from fielding group by playerid, yearid union select playerid, yearid from pitching group by playerid, yearid), result as (select playerid, count(distinct(yearid)) as num_seasons from all_tables group by playerid) select r.playerid, coalesce(p.namefirst,'') as firstname, coalesce(p.namelast,'') as lastname, coalesce(birthyear || '-' || lpad(birthmonth::text,2,'0') || '-' || lpad(birthday::text,2,'0'),'') as date_of_birth, r.num_seasons from result r join people p on r.playerid = p.playerid order by r.num_seasons desc, r.playerid asc;
with totalSeasons as ( select playerID, yearID from Batting union select playerID, yearID from Fielding union select playerID, yearID from Pitching ), numSeasonsTable as ( select playerID, count(distinct yearID) as num_seasons from totalSeasons group by playerID ) select People.playerID as playerid, People.nameFirst as firstname, People.nameLast as lastname, People.birthYear || '-' || People.birthMonth || '-' || People.birthDay as date_of_birth, num_seasons from numSeasonsTable, People where numSeasonsTable.playerID = People.playerID order by num_seasons desc, playerid asc, firstname asc, lastname asc, date_of_birth asc;
